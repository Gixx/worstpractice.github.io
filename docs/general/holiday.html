<!DOCTYPE html><html lang="en">
  <head>
    <meta charset="utf-8">
    <title>I give up the Advent of Code&nbsp;-&nbsp;Worst Practice
    </title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0">
    <meta name="language" content="en">
    <meta name="robots" content="index,follow">
    <meta name="generator" content="jekyll 3.8.5">
    <meta name="revisit-after" content="7 days">
    <meta name="distribution" content="web">
    <meta name="copyright" content="Copyright © 2022 All rights reserved. Worst Practice.">
    <meta name="description" content="
">
    <meta name="subject" content="">
    <meta name="keywords" content="PHP, Advent of Code">
    <!-- facebook share -->
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Worst Practice">
    <meta property="og:title" content="I give up the Advent of Code&nbsp;-&nbsp;Worst Practice
">
    <meta property="og:url" content="https://www.worstpractice.dev/general/holiday">
    <meta name="date" content="2022-12-19T08:00:00+00:00">
    <meta property="og:image" content="https://www.worstpractice.dev/assets/img/blog/2022/general/holiday/advent-end.jpg">
    <meta property="og:image:width" content="600">
    <meta property="og:image:height" content="600">
    <meta property="og:description" content="In the last days the Advent of Code went into Advanced of Code.">
    <meta property="fb:admins" content="ivan.gabor.80">
    <meta property="fb:app_id" content="2178081495757871">
    <meta property="og:type" content="article">
    <meta property="article:author" content="https://www.facebook.com/ivan.gabor.80">
    <meta property="article:published_time" content="2022-12-19T08:00:00+00:00">
    <meta property="article:tag" content="blog"/>
    <!-- twitter share -->
    <meta name="twitter:title" content="I give up the Advent of Code">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:creator" content="@gaborivan1980">
    <meta name="twitter:description" content="In the last days the Advent of Code went into Advanced of Code.">
    <meta name="twitter:image" content="https://www.worstpractice.dev/assets/img/blog/2022/general/holiday/advent-end_600x600.jpg">
    <link rel="canonical" href="https://www.worstpractice.dev">
    <link rel="alternate" type="application/rss+xml" title="I give up the Advent of Code&nbsp;-&nbsp;Worst Practice
" href="/feed.xml">
    <link rel="alternate" hreflang="en" href="https://www.worstpractice.dev/general/holiday">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/img/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/img/icons/android-chrome-192x192.png">
    <link rel="manifest" href="/assets/img/icons/site.webmanifest">
    <link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg" color="#C23F2F">
    <link rel="shortcut icon" href="/assets/img/icons/favicon.ico">
    <meta name="msapplication-TileColor" content="#C23F2F">
    <meta name="msapplication-TileImage" content="/assets/img/icons/mstile-144x144.png">
    <meta name="msapplication-config" content="/assets/img/icons/browserconfig.xml">
    <meta name="theme-color" content="#C23F2F">
    <meta name="application-name" content="Worst Practice Blog">
    <meta name="HandheldFriendly" content="true">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#C23F2F">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:300,300i,400,400i,700,700i">
    <link rel="stylesheet" href="/assets/css/site.css">
    <script type="application/javascript" src="/assets/js/feature.min.js"></script>
    <script type="application/javascript">
      if (!feature.srcset) {
          window.location.href = '/sorry.html';
      }
    </script>
    <script type="application/javascript" src="/assets/js/site.min.js"></script>
  </head>
  <body>
    <header class="h-header">
      <h1 class="h-header__title"><a href="/">Worst Practice</a></h1>
    </header>
    <div class="codeOfTheDay">
      <input class="codeOfTheDay__toggle" type="checkbox">
      <div class="codeOfTheDay__content"></div>
      <div class="codeOfTheDay__monitor"></div>
      <div class="codeOfTheDay__backdrop"></div>
    </div>
    <div class="m-menu">
      <div class="m-menu__burger">
        <span></span>
      </div>
      <input class="m-menu__toggle" type="checkbox" />
      <div class="m-menu__content">
        <nav>
          <h2 class="m-menu__title">Worst Practice</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -home" href="/">Home</a></li>
          </ul>
        </nav>
        <nav>
          <h2 class="m-menu__title">Categories</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -general -current" href="/general">General</a></li>
            <li><a class="m-menu__link -backend" href="/backend">Backend</a></li>
            <li><a class="m-menu__link -devenv" href="/devenv">Development Environment</a></li>
            <li><a class="m-menu__link -frontend" href="/frontend">Frontend</a></li>
            <li><a class="m-menu__link -general
" href="/general
">General</a></li>
          </ul>
        </nav>
        <nav>
          <h2 class="m-menu__title">Tags</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -php" rel="tag" href="/tags/php/">PHP <sup>20</sup></a></li>
            <li><a class="m-menu__link -advent" rel="tag" href="/tags/advent/">Advent <sup>15</sup></a></li>
            <li><a class="m-menu__link -php74" rel="tag" href="/tags/php74/">PHP 7.4 <sup>4</sup></a></li>
          </ul>
          <a class="m-menu__link -more" href="/tags/">More</a>
        </nav>
        <nav>
          <h2 class="m-menu__title">Archive</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link " href="/archive/2022-12/">December, 2022</a></li>
            <li><a class="m-menu__link " href="/archive/2022-11/">November, 2022</a></li>
            <li><a class="m-menu__link " href="/archive/2022-10/">October, 2022</a></li>
          </ul>
          <a class="m-menu__link -more" href="/archive/">More</a>
        </nav>
        <nav>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link " href="/imprint.html">Imprint</a></li>
            <li><a class="m-menu__link " href="/terms.html">Terms of Use</a></li>
            <li><a class="m-menu__link " href="/privacy.html">Privacy Policy</a></li>
          </ul>
        </nav>
      </div>
      <div class="m-menu__backdrop"></div>
    </div>
    <main class="c-content">
      <section class="c-content__article">
        <article class="a-article">
          <header class="a-header">
            <h2 class="a-header__title">I give up the Advent of Code</h2>
            <div class="a-header__meta">
              <p class="a-meta__date">Posted on December&nbsp;19, 2022 @ 08:00
              </p>
              <p class="a-meta__category">Posted under the <a href="/general/index.html">General</a> category</p>
              <p class="a-meta__tags">Posted with the following tags:
                <a href="/tags/personal/index.html">#Personal</a>
              </p>
            </div>
          </header>
          <p class="a-excerpt">
            In the last days the Advent of Code went into Advanced of Code.
          </p>
          <figure class="a-illustration">
            <img class="a-illustration__image" src="/assets/img/post-illustration-placeholder.png" data-src="/assets/img/blog/2022/general/holiday/advent-end.jpg" alt="I give up the Advent of Code">
            <figcaption class="a-illustration__caption">Image by <a rel="noopener" target="_blank" href="https://pixabay.com/users/qimono-1962238/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1767563">Arek Socha</a> from <a rel="noopener" target="_blank" href="https://pixabay.com//?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1767563">Pixabay</a></figcaption>
          </figure>
          <div class="a-body">
            <h3 id="sad-but-true">Sad but true</h3>
            <p>In the last days (December 16 - 17) I was struggling to solve the tasks of the AoC. They seem to be more difficult than 
              I can solve them with an average web developer knowledge.</p>
            <p>Yes, they are only algorithms. Yes, I could figure out the 16th, and the 17th algorithm, and I also wrote it and solved 
              the first part fluently. My solution proved that it works with the second task as well, but only on the example data.</p>
            <p>Unfortunately my solutions were so hungry for resources, that they couldn’t deal with the part two of the puzzle with 
              the real input.</p>
            <p>Now I feel depressed and disappointed again. But this was the first time, I tried this challenge and I could solve more
              than the half of it. So in the end of the day, I still can be a bit proud of myself. Maybe, there would be some puzzles 
              in the rest of the days that I could still solve, but this game should be done for fun and relaxation, and not to be
              nervous and depressed. I already sacrificed two full Saturdays in a row for this challenge, and that’s too much price.</p>
            <p>So I think it’s really time to stop here and now. It’s Christmastime, and I must not prefer this coding game over my
              family.</p>
            <p>I will spend the rest of the year with relaxation - hopefully.</p>
            <h3 id="the-hints">The hints</h3>
            <p>Probably you could find much better solutions than my PHP codes. But hey, it’s the Worst Practice!</p>
            <h4 id="16th-of-december">16th of December</h4>
            <p>This task truly fucked my brain through the North Korean border. I have never had to deal with graphs, maybe once on the 
              university twenty-something years ago. So first I had to search the internet which way should I start. This is how I 
              found the <a rel="noopener" target="_blank" href="https://www.programmingalgorithms.com/algorithm/floyd%E2%80%93warshall-algorithm/php/">Floyd Warshall algorithm</a>.</p>
            <p>So I had to build up the graph, then make a distance graph for it, then walk the whole thing:</p>
            <div class="language-php highlighter-rouge">
              <div class="highlight">
                <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
</pre>
              </td>
              <td class="rouge-code">
                <pre><span class="kd">class</span> <span class="nc">Valve</span> 
<span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Cave</span>
<span class="p">{</span>
    <span class="c1">//...</span>
    
    <span class="k">private</span> <span class="k">function</span> <span class="n">intiDistanceGraph</span><span class="p">():</span> <span class="kt">void</span> <span class="p">{</span>
        <span class="nb">sort</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valveNames</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">distanceGraph</span> <span class="o">=</span> <span class="nb">array_fill_keys</span><span class="p">(</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valveNames</span><span class="p">,</span>
            <span class="nb">array_fill_keys</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valveNames</span><span class="p">,</span> <span class="k">self</span><span class="o">::</span><span class="no">INFINITE</span><span class="p">)</span>
        <span class="p">);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">applyFloydWarshall</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">function</span> <span class="n">applyFloydWarshall</span><span class="p">():</span> <span class="kt">void</span>
    <span class="p">{</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valves</span> <span class="k">as</span> <span class="nv">$name</span> <span class="o">=&gt;</span> <span class="nv">$valve</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$valve</span><span class="o">-&gt;</span><span class="n">tunnels</span> <span class="k">as</span> <span class="nv">$valveName</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">distanceGraph</span><span class="p">[</span><span class="nv">$name</span><span class="p">][</span><span class="nv">$valveName</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valves</span> <span class="k">as</span> <span class="nv">$name1</span> <span class="o">=&gt;</span> <span class="nv">$valve1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valves</span> <span class="k">as</span> <span class="nv">$name2</span> <span class="o">=&gt;</span> <span class="nv">$valve2</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valves</span> <span class="k">as</span> <span class="nv">$name3</span> <span class="o">=&gt;</span> <span class="nv">$valve3</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">distanceGraph</span><span class="p">[</span><span class="nv">$name2</span><span class="p">][</span><span class="nv">$name3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">distanceGraph</span><span class="p">[</span><span class="nv">$name2</span><span class="p">][</span><span class="nv">$name3</span><span class="p">],</span>
                        <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">distanceGraph</span><span class="p">[</span><span class="nv">$name2</span><span class="p">][</span><span class="nv">$name1</span><span class="p">]</span> <span class="o">+</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">distanceGraph</span><span class="p">[</span><span class="nv">$name1</span><span class="p">][</span><span class="nv">$name3</span><span class="p">])</span>
                    <span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">getHighestReleasablePressure</span><span class="p">(</span><span class="kt">string</span> <span class="nv">$currentValveName</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span> <span class="kt">int</span> <span class="nv">$timeSpent</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span> <span class="kt">int</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valvesOpened</span><span class="p">)</span> <span class="o">===</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valvesWithPressure</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$currentValveName</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$currentValveName</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">startPosition</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nv">$currentValve</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valves</span><span class="p">[</span><span class="nv">$currentValveName</span><span class="p">];</span>
        <span class="nv">$pressure</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valvesWithPressure</span> <span class="k">as</span> <span class="nv">$targetValveName</span> <span class="o">=&gt;</span> <span class="nv">$targetValve</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valvesOpened</span><span class="p">[</span><span class="nv">$targetValveName</span><span class="p">]))</span> <span class="p">{</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nv">$newTimeSpent</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">distanceGraph</span><span class="p">[</span><span class="nv">$currentValve</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">][</span><span class="nv">$targetValveName</span><span class="p">]</span> <span class="o">+</span> <span class="nv">$timeSpent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="nv">$newTimeSpent</span> <span class="o">&lt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">timeLimit</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valvesOpened</span><span class="p">[</span><span class="nv">$targetValveName</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$targetValve</span><span class="p">;</span>
                <span class="nv">$currentReleasePressure</span> <span class="o">=</span> <span class="nv">$targetValve</span><span class="o">-&gt;</span><span class="n">pressure</span> <span class="o">*</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">timeLimit</span> <span class="o">-</span> <span class="nv">$newTimeSpent</span><span class="p">);</span>
                <span class="nv">$targetValveReleasePressure</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">getHighestReleasablePressure</span><span class="p">(</span><span class="nv">$targetValveName</span><span class="p">,</span> <span class="nv">$newTimeSpent</span><span class="p">);</span>

                <span class="nb">unset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">valvesOpened</span><span class="p">[</span><span class="nv">$targetValveName</span><span class="p">]);</span>

                <span class="nv">$pressure</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nv">$pressure</span><span class="p">,</span> <span class="p">(</span><span class="nv">$currentReleasePressure</span> <span class="o">+</span> <span class="nv">$targetValveReleasePressure</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$pressure</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
              </td>
            </tr>
          </tbody>
        </table>
      </code></pre>
  </div>
</div>
<p>Probably this is the least efficient way to solve this puzzle.</p>
<h4 id="17th-of-december">17th of December</h4>
<p>The base concept of the puzzle is quite interesting. It’s a kind of low budget Tetris game. No turning, no line eliminations.
  I’m not a game developer, I don’t have any experience with long term, multi-steps game strategies, but I tried my best.</p>
<p>In the end it turned out, probably my best is the worst here, hehehe.</p>
<p>So the game is about falling shapes will pile up. The shapes can be imagined as two-dimensional arrays with zeros and ones.
  So we need to find a way to merge two arrays to not overlap the ones. OR, how about we represent them as a string and simply
  do some binary checks? They are zeros and ones for God’s sake!</p>
<p>This is the way I chose to go on. Yes, again: the theory is simple, the solution is not. It turned out to be extremely slow.
  Probably my code is wrong, and maybe the PHP is not the best platform for these task, I don’t know.</p>
<p>But here is what I made:</p>
<div class="language-php highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="nv">$line</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="k">__DIR__</span><span class="mf">.</span><span class="s1">'/input.txt'</span><span class="p">));</span>

<span class="nv">$gasFlow</span> <span class="o">=</span> <span class="nb">str_split</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span>
<span class="nv">$rocks</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">0</span> <span class="o">=&gt;</span> <span class="s1">'0000000'</span><span class="mf">.</span><span class="s1">'0000000'</span><span class="mf">.</span><span class="s1">'0000000'</span><span class="mf">.</span><span class="s1">'0011110'</span><span class="p">,</span>
    <span class="mi">1</span> <span class="o">=&gt;</span> <span class="s1">'0000000'</span><span class="mf">.</span><span class="s1">'0001000'</span><span class="mf">.</span><span class="s1">'0011100'</span><span class="mf">.</span><span class="s1">'0001000'</span><span class="p">,</span>
    <span class="mi">2</span> <span class="o">=&gt;</span> <span class="s1">'0000000'</span><span class="mf">.</span><span class="s1">'0000100'</span><span class="mf">.</span><span class="s1">'0000100'</span><span class="mf">.</span><span class="s1">'0011100'</span><span class="p">,</span>
    <span class="mi">3</span> <span class="o">=&gt;</span> <span class="s1">'0010000'</span><span class="mf">.</span><span class="s1">'0010000'</span><span class="mf">.</span><span class="s1">'0010000'</span><span class="mf">.</span><span class="s1">'0010000'</span><span class="p">,</span>
    <span class="mi">4</span> <span class="o">=&gt;</span> <span class="s1">'0000000'</span><span class="mf">.</span><span class="s1">'0000000'</span><span class="mf">.</span><span class="s1">'0011000'</span><span class="mf">.</span><span class="s1">'0011000'</span><span class="p">,</span>
<span class="p">];</span>

<span class="nv">$areaWalls</span> <span class="o">=</span> <span class="s1">'1'</span><span class="mf">.</span><span class="s1">'0000000'</span><span class="mf">.</span><span class="s1">'1'</span><span class="mf">.</span><span class="s1">'0000000'</span><span class="mf">.</span><span class="s1">'1'</span><span class="mf">.</span><span class="s1">'0000000'</span><span class="mf">.</span><span class="s1">'1'</span><span class="mf">.</span><span class="s1">'0000000'</span><span class="mf">.</span><span class="s1">'1'</span><span class="p">;</span>

<span class="nv">$rocksFallen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nv">$rockIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nv">$gasFlowIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="nv">$emptyArea</span> <span class="o">=</span> <span class="nb">array_fill</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">'0000000'</span><span class="p">);</span>
<span class="nv">$area</span> <span class="o">=</span> <span class="nb">array_fill</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">'0000000'</span><span class="p">);</span>
<span class="nv">$actualAreaSlice</span> <span class="o">=</span> <span class="nv">$emptyArea</span><span class="p">;</span>
<span class="nv">$actualAreaMask</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="nv">$actualAreaSlice</span><span class="p">);</span>
<span class="nv">$totalArea</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="k">do</span> <span class="p">{</span>
    <span class="nv">$actualRockMask</span> <span class="o">=</span> <span class="nv">$rocks</span><span class="p">[</span><span class="nv">$rockIndex</span><span class="p">];</span>
    <span class="nv">$actualRockSlice</span> <span class="o">=</span> <span class="nb">str_split</span><span class="p">(</span><span class="nv">$actualRockMask</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
    <span class="nv">$areaIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nv">$falling</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="c1">// Check fall and slide until hit a rock or the ground</span>
    <span class="k">while</span> <span class="p">(</span><span class="nv">$falling</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Pick the next 4 rows</span>
        <span class="nv">$nextAreaSlice</span> <span class="o">=</span> <span class="nb">array_slice</span><span class="p">(</span><span class="nv">$area</span><span class="p">,</span> <span class="nv">$areaIndex</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
        <span class="c1">// Make a bitmask like the rocks</span>
        <span class="nv">$nextAreaMask</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">''</span><span class="p">,</span> <span class="nv">$nextAreaSlice</span><span class="p">);</span>

        <span class="c1">// If there's a hit with another rock, this step is invalid, quit</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">bindec</span><span class="p">(</span><span class="nv">$actualRockMask</span> <span class="o">&amp;</span> <span class="nv">$nextAreaMask</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// We made sure to always have enough free space "above", so there won't be underflow with the index.</span>
            <span class="nv">$areaIndex</span><span class="o">--</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Apply falling</span>
        <span class="nv">$actualAreaSlice</span> <span class="o">=</span> <span class="nv">$nextAreaSlice</span><span class="p">;</span>
        <span class="nv">$actualAreaMask</span> <span class="o">=</span> <span class="nv">$nextAreaMask</span><span class="p">;</span>

        <span class="c1">// We hit the ground but we can slide once more</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$areaIndex</span> <span class="o">===</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$area</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$falling</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Make a bitmask like the area walls by adding placeholders</span>
        <span class="nv">$actualAreaMaskWithWalls</span> <span class="o">=</span> <span class="s1">'0'</span><span class="mf">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">'0'</span><span class="p">,</span> <span class="nv">$actualAreaSlice</span><span class="p">)</span><span class="mf">.</span><span class="s1">'0'</span><span class="p">;</span>
        <span class="c1">// By pre-adding the placeholders for the walls, we can make sure the bit shift won't cause overflow or make floating pont number</span>
        <span class="nv">$actualRockMaskWithWalls</span> <span class="o">=</span> <span class="s1">'0'</span><span class="mf">.</span> <span class="nb">implode</span><span class="p">(</span><span class="s1">'0'</span><span class="p">,</span> <span class="nv">$actualRockSlice</span><span class="p">)</span><span class="mf">.</span><span class="s1">'0'</span><span class="p">;</span>

        <span class="nv">$nextMove</span> <span class="o">=</span> <span class="nv">$gasFlow</span><span class="p">[</span><span class="nv">$gasFlowIndex</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$nextMove</span> <span class="o">===</span> <span class="s1">'&lt;'</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Check move left</span>
            <span class="nv">$actualRockMaskWithWalls</span> <span class="o">=</span> <span class="nb">str_pad</span><span class="p">(</span><span class="nb">decbin</span><span class="p">(</span><span class="nb">bindec</span><span class="p">(</span><span class="nv">$actualRockMaskWithWalls</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">28</span> <span class="o">+</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">'0'</span><span class="p">,</span> <span class="no">STR_PAD_LEFT</span><span class="p">);</span>
            <span class="nv">$multiply</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// Check right</span>
            <span class="nv">$actualRockMaskWithWalls</span> <span class="o">=</span> <span class="nb">str_pad</span><span class="p">(</span><span class="nb">decbin</span><span class="p">(</span><span class="nb">bindec</span><span class="p">(</span><span class="nv">$actualRockMaskWithWalls</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">28</span> <span class="o">+</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">'0'</span><span class="p">,</span> <span class="no">STR_PAD_LEFT</span><span class="p">);</span>
            <span class="nv">$multiply</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nv">$freeSpaces</span> <span class="o">=</span> <span class="nv">$areaWalls</span> <span class="o">|</span> <span class="nv">$actualAreaMaskWithWalls</span><span class="p">;</span>

        <span class="c1">// If we don't hit the wall or any rock, we apply the bit shift on the original rock mask</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">bindec</span><span class="p">(</span><span class="nv">$actualRockMaskWithWalls</span> <span class="o">&amp;</span> <span class="nv">$freeSpaces</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$actualRockMask</span> <span class="o">=</span>  <span class="nb">str_pad</span><span class="p">(</span><span class="nb">decbin</span><span class="p">(</span><span class="nb">bindec</span><span class="p">(</span><span class="nv">$actualRockMask</span><span class="p">)</span> <span class="o">*</span> <span class="nv">$multiply</span><span class="p">),</span> <span class="mi">28</span><span class="p">,</span> <span class="s1">'0'</span><span class="p">,</span> <span class="no">STR_PAD_LEFT</span><span class="p">);</span>
            <span class="nv">$actualRockSlice</span> <span class="o">=</span> <span class="nb">str_split</span><span class="p">(</span><span class="nv">$actualRockMask</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// try falling and shifting again</span>
        <span class="nv">$areaIndex</span><span class="o">++</span><span class="p">;</span>
        <span class="nv">$gasFlowIndex</span><span class="o">++</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$gasFlowIndex</span> <span class="o">&gt;=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$gasFlow</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$gasFlowIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Make new mask</span>
    <span class="nv">$actualAreaAndRockMask</span> <span class="o">=</span> <span class="nv">$actualAreaMask</span> <span class="o">|</span> <span class="nv">$actualRockMask</span><span class="p">;</span>
    <span class="c1">// Create new slice</span>
    <span class="nv">$actualAreaAndRockSlice</span> <span class="o">=</span> <span class="nb">str_split</span><span class="p">(</span><span class="nv">$actualAreaAndRockMask</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
    <span class="c1">// Replace old slice with new</span>
    <span class="nb">array_splice</span><span class="p">(</span><span class="nv">$area</span><span class="p">,</span> <span class="nv">$areaIndex</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nv">$actualAreaAndRockSlice</span><span class="p">);</span>

    <span class="nv">$rocksFallen</span><span class="o">++</span><span class="p">;</span>
    <span class="nv">$rockIndex</span><span class="o">++</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$rockIndex</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$rockIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nv">$emptyLinesInArea</span> <span class="o">=</span> <span class="nb">array_filter</span><span class="p">(</span><span class="nv">$area</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$row</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$row</span> <span class="o">===</span> <span class="s1">'0000000'</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="c1">// Add new empty lines if needed</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$emptyLinesInArea</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$num</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">-</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$emptyLinesInArea</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$num</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">array_unshift</span><span class="p">(</span><span class="nv">$area</span><span class="p">,</span><span class="s1">'0000000'</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">while</span> <span class="p">(</span><span class="nv">$rocksFallen</span> <span class="o">&lt;</span> <span class="mi">2022</span><span class="p">);</span>

<span class="nv">$filledLinesInArea</span> <span class="o">=</span> <span class="nb">array_filter</span><span class="p">(</span><span class="nv">$area</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$row</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$row</span> <span class="o">!==</span> <span class="s1">'0000000'</span><span class="p">;</span>
<span class="p">});</span>

<span class="k">echo</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$filledLinesInArea</span><span class="p">)</span><span class="mf">.</span><span class="kc">PHP_EOL</span><span class="p">;</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<p>As an idea, I think it was not that terrible, the solution definitely is. A true Worst Practice.</p>
</div>
<footer class="a-footer">
  <h3 class="a-footer__title">About the author</h3>
  <a class="a-footer__avatar" href="/author/gabor.ivan/index.html"><img src="/author/gabor.ivan/avatar.jpg" alt="Gábor Iván"></a>
  <p class="a-footer__author">
    Hi, my name is Gábor Iván. I am an old-school Full stack developer, which means I deal with Backend (PHP), Frontend (HTML, CSS, JS), and a little bit of Webdesign. No DevOPS, sorry.
    <br>
    <a href="/author/gabor.ivan/index.html">Read the full story</a>
  </p>
</footer>
</article>
<aside class="a-comments">
  <header class="a-comments__title">
    <h4>It's time to judge me!</h4>
  </header>
  <div id="general">
    There's no embedded tool to judge me in public. But don't worry, you can
    <a class="mailto" href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#119;&#111;&#114;&#115;&#116;&#46;&#112;&#114;&#97;&#99;&#116;&#105;&#99;&#101;&#46;&#98;&#108;&#111;&#103;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;?subject=Judgement on `I give up the Advent of Code`" target="_blank" rel="noopener" rel="noopener noreferrer">write me</a>
    your opinions/ideas/suggestions in email. Please don't forget to reference the page in the message.
  </div>
</aside>
</section>
</main>
<footer class="f-footer">
  <p class="f-footer__copyright">
    <small>Copyright © 2023 All rights reserved. Worst Practice</small>
  </p>
</footer>
</body>
</html>