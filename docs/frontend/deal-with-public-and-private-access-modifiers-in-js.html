<!DOCTYPE html><html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Deal with &#39;public&#39; and &#39;private&#39; access modifiers in JS&nbsp;-&nbsp;Worst Practice</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0">
    <meta name="language" content="en">
    <meta name="robots" content="index,follow">
    <meta name="generator" content="jekyll 3.8.5">
    <meta name="revisit-after" content="7 days">
    <meta name="distribution" content="web">
    <meta name="theme-color" content="#3B5999">
    <meta name="copyright" content="Copyright © 2020 All rights reserved. Worst Practice.">
    <meta name="description" content="">
    <meta name="subject" content="">
    <meta name="keywords" content="JS, JavaScript, OOP, Object-Oriented Programming, Class, Private, Public, access modifiers, getter, setter">
    <!-- facebook share -->
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Worst Practice">
    <meta property="og:title" content="Deal with &#39;public&#39; and &#39;private&#39; access modifiers in JS&nbsp;-&nbsp;Worst Practice">
    <meta property="og:url" content="https://www.worstpractice.dev/frontend/deal-with-public-and-private-access-modifiers-in-js">
    <meta name="date" content="2020-02-19T20:00:00+01:00">
    <meta property="og:image" content="https://www.worstpractice.dev/assets/img/blog/2020/frontend/deal-with-public-and-private-access-modifiers-in-js/">
    <meta property="og:image:width" content="600">
    <meta property="og:image:height" content="600">
    <meta property="og:description" content="I asked my frontend-pro friends and colleagues to tell me their honest opinions about my codes. Well, I got it. This is the absolute worst practice I&#39;m afraid.">
    <meta property="fb:admins" content="ivan.gabor.80">
    <meta property="fb:app_id" content="2178081495757871">
    <meta property="og:type" content="article">
    <meta property="article:author" content="https://www.facebook.com/ivan.gabor.80">
    <meta property="article:published_time" content="2020-02-19T20:00:00+01:00">
    <meta property="article:tag" content="blog"/>
    <!-- twitter share -->
    <meta name="twitter:title" content="Deal with 'public' and 'private' access modifiers in JS">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:creator" content="@gaborivan1980">
    <meta name="twitter:description" content="I asked my frontend-pro friends and colleagues to tell me their honest opinions about my codes. Well, I got it. This is the absolute worst practice I&#39;m afraid.">
    <meta name="twitter:image" content="https://www.worstpractice.dev/assets/img/blog/2020/frontend/deal-with-public-and-private-access-modifiers-in-js/">
    <link rel="canonical" href="https://www.worstpractice.dev">
    <link rel="alternate" type="application/rss+xml" title="Deal with &#39;public&#39; and &#39;private&#39; access modifiers in JS&nbsp;-&nbsp;Worst Practice" href="/feed.xml">
    <link rel="alternate" hreflang="en" href="https://www.worstpractice.dev/frontend/deal-with-public-and-private-access-modifiers-in-js">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/img/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/img/icons/android-chrome-192x192.png">
    <link rel="manifest" href="/assets/img/icons/site.webmanifest">
    <link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/assets/img/icons/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/assets/img/icons/mstile-144x144.png">
    <meta name="msapplication-config" content="/assets/img/icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <meta name="application-name" content="Worst Practice Blog">
    <meta name="HandheldFriendly" content="true">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:300,300i,400,400i,700,700i">
    <link rel="stylesheet" href="/assets/css/desktop.css" media="screen and (min-width: 1025px)">
    <link rel="stylesheet" href="/assets/css/tablet.css"  media="screen and (max-width: 1024px) and (orientation:landscape)">
    <link rel="stylesheet" href="/assets/css/tablet.css"  media="screen and (min-width: 481px) and (max-width: 1024px) and (orientation:portrait)">
    <link rel="stylesheet" href="/assets/css/mobile.css"  media="screen and (max-width: 480px)">
    <script type="application/javascript" src="/assets/js/feature.min.js"></script>
    <script type="application/javascript">
      if (!feature.srcset) {
          window.location.href = '/sorry.html';
      }
    </script>
    <script type="application/javascript" src="/assets/js/site.min.js"></script>
  </head>
  <body>
    <header class="h-header">
      <h1 class="h-header__title"><a href="/">Worst Practice</a></h1>
    </header>
    <div class="codeOfTheDay">
      <input class="codeOfTheDay__toggle" type="checkbox">
      <div class="codeOfTheDay__content"></div>
      <div class="codeOfTheDay__backdrop"></div>
    </div>
    <div class="m-menu">
      <div class="m-menu__burger">
        <span></span>
      </div>
      <input class="m-menu__toggle" type="checkbox" />
      <div class="m-menu__content">
        <nav>
          <h2 class="m-menu__title">Worst Practice</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -home" href="/">Home</a></li>
          </ul>
        </nav>
        <nav>
          <h2 class="m-menu__title">Categories</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -frontend -current" href="/frontend">Frontend</a></li>
            <li><a class="m-menu__link -wsl" href="/wsl">WSL</a></li>
            <li><a class="m-menu__link -general" href="/general">General</a></li>
          </ul>
        </nav>
        <nav>
          <h2 class="m-menu__title">Tags</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -wsl2" rel="tag" href="/tags/wsl2/">WSL2 <sup>1</sup></a></li>
            <li><a class="m-menu__link -windows" rel="tag" href="/tags/windows/">Windows <sup>1</sup></a></li>
            <li><a class="m-menu__link -smart" rel="tag" href="/tags/smart/">Smart <sup>1</sup></a></li>
          </ul>
          <a class="m-menu__link -more" href="/tags/">More</a>
        </nav>
        <nav>
          <h2 class="m-menu__title">Archive</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link " href="/archive/2020-02/">February, 2020</a></li>
            <li><a class="m-menu__link " href="/archive/2020-01/">January, 2020</a></li>
          </ul>
        </nav>
        <nav>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link " href="/imprint.html">Imprint</a></li>
            <li><a class="m-menu__link " href="/terms.html">Terms of Use</a></li>
            <li><a class="m-menu__link " href="/privacy.html">Privacy Policy</a></li>
          </ul>
        </nav>
      </div>
      <div class="m-menu__backdrop"></div>
    </div>
    <main class="c-content">
      <section class="c-content__article">
        <article class="a-article">
          <header class="a-header">
            <h2 class="a-header__title">Deal with &#39;public&#39; and &#39;private&#39; access modifiers in JS</h2>
            <div class="a-header__meta">
              <p class="a-meta__date">Posted on February&nbsp;19, 2020 20:00</p>
              <p class="a-meta__category">Posted under the <a href="/frontend/index.html">Frontend</a> category</p>
              <p class="a-meta__level">Level: Beginner</p>
              <p class="a-meta__tags">Posted with the following tags:
                <a href="/tags/js/index.html">#JS</a>, 
                <a href="/tags/oop/index.html">#OOP</a>
              </p>
            </div>
          </header>
          <p class="a-excerpt">
            I asked my frontend-pro friends and colleagues to tell me their honest opinions about my codes. Well, I got it. This is the absolute worst practice I'm afraid.
          </p>
          <div class="a-body">
            <h3 id="my-concept">My concept</h3>
            <p>You’d better know, I am basically a backend developer. Or, as I used to say with a little bit of humor and a piece of well-deserved self-critics:</p>
            <blockquote>
              <p>I am a Full-STUCK Señor PHP Developer</p>
            </blockquote>
            <p>Most of my time in the office I deal with corporate PHP codes, and try to give my best in it, and I also try to improve my skills. I write object-oriented
              code 99% during the work by using the most hyped and recommended patterns, such as Dependency Injection, Adapter, Factory, MVC, etc. So I use OO day-by-day,
              and I learned to think in the object-styled encapsulation during my years in the industry. In fact I already see the world in Objects…!
              That’s totally crazy, isn’t it?</p>
            <p>And when I deal with JavaScript for myself, like on this blog, where I can give myself free hand, I try to somehow adopt this ‘knowledge’ too. But we
              all know that, in the native way it is not that simple. It needs a different kind of thinking, which I find a bit weird and triple-twisted. There are
              objects of a kind, and since ES6 there are classes too, but not in the <code class="highlighter-rouge">class</code>ical way (Ha-Ha-Ha). Scope, inheritance, access modifiers and in general
              everything is just different. Well, JavaScript is a different animal for sure… that’s what they used to say.</p>
            <p>I know, there are many many wonderful frameworks and libraries to develop JavaScript. I could do React, Svelte, Vue and so on. But I don’t. Not right now.
              I want to do something simple, something on my own. I like to reinvent the wheel, and even if it will be a shitty one, it will be mine. And I don’t want
              to go deep in the soul of the JavaScript development now, and define terms, understand the whys, find the good way I ought to follow.</p>
            <p>The first step for a dummy / lame / rookie / amateur like me is to try to create something for my own. Make it work. Then, when I have some experience,
              I can learn the proper ‘How’. You can’t qualify yourself to the 100m sprint on the Olympic games until you can’t even walk, can you? And how do you learn
              to walk? Try it, do it, fail and retry.</p>
            <p>So I decided to use my understanding of the <code class="highlighter-rouge">Object</code>, and with the available tools of the JavaScript’s arsenal, I create something, in which I can feel
              myself comfortable when I code. Of course to achieve this, I had to give up some of OO things temporarily, and stick to a very basic concept:</p>
            <ul>
              <li>encapsulate properties and methods together</li>
              <li>support <code class="highlighter-rouge">public</code> and <code class="highlighter-rouge">private</code> access in some way</li>
              <li>no need for inheritance right now</li>
            </ul>
            <p>I tried several different ways before I choose the following two cases. Both have pros and cons. To be comparable I’ve made the same <code class="highlighter-rouge">Yet-another</code>
              UUID generator class.</p>
            <h4 id="way-1-clean-but-vulnerable">Way 1: clean but vulnerable.</h4>
            <p>This can be called a more ‘standard’ solution.</p>
            <div class="language-js highlighter-rouge">
              <div class="highlight">
                <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre>
              </td>
              <td class="rouge-code">
                <pre><span class="cm">/**
 * @typedef {Object} MyClass1
 * @property {function(): string} generateUUID
 * @property {string} nilUUID
 */</span>

<span class="cm">/**
 * @constructor
 */</span>
<span class="kd">const</span> <span class="nx">MyClass1</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
<span class="p">{</span>
    <span class="cm">/** @type {array} */</span>
    <span class="kd">const</span> <span class="nx">AVAILABLE_CHARACTERS</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz</span><span class="dl">'</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>

    <span class="cm">/** @type {array} */</span>
    <span class="kd">const</span> <span class="nx">uuidTemplate</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">xxxxxxxx-xxxx-!xxx-?xxx-xxxxxxxxxxxx</span><span class="dl">'</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>

    <span class="cm">/** @type {string} */</span>
    <span class="kd">const</span> <span class="nx">uuidVersion</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">4</span><span class="dl">'</span><span class="p">;</span>

    <span class="cm">/**
     * @returns {string}
     */</span>
    <span class="kd">const</span> <span class="nx">getNilUUID</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="dl">'</span><span class="s1">00000000-0000-0000-0000-000000000000</span><span class="dl">'</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="cm">/** @type {string} */</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">nilUUID</span> <span class="o">=</span> <span class="nx">getNilUUID</span><span class="p">();</span>

    <span class="cm">/**
     * Generate a valid UUID
     * @see https://en.wikipedia.org/wiki/Universally_unique_identifier
     *
     * @return {string}
     */</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">generateUUID</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">isNilUUID</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">isNilUUID</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">nilUUID</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kd">let</span> <span class="nx">uuidVariant</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">random</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">uuid</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">uuidTemplate</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">random</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">|</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">16</span><span class="p">;</span>
            <span class="nx">uuidVariant</span> <span class="o">=</span> <span class="p">(</span><span class="nx">random</span> <span class="o">&amp;</span> <span class="mh">0x3</span><span class="p">)</span>  <span class="o">|</span> <span class="mh">0x8</span><span class="p">;</span>

            <span class="nx">uuid</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">uuidTemplate</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
                <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">[^\-\!\?]</span><span class="sr">/</span><span class="p">,</span> <span class="nx">AVAILABLE_CHARACTERS</span><span class="p">[</span><span class="nx">random</span><span class="p">])</span>
                <span class="c1">// ! is the uuid version</span>
                <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="dl">'</span><span class="s1">!</span><span class="dl">'</span><span class="p">,</span> <span class="nx">uuidVersion</span><span class="p">)</span>
                <span class="c1">// ? is the high bits of clock sequence according to rfc4122</span>
                <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="dl">'</span><span class="s1">?</span><span class="dl">'</span><span class="p">,</span> <span class="nx">AVAILABLE_CHARACTERS</span><span class="p">[</span><span class="nx">uuidVariant</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">uuid</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>
    <span class="p">};</span>
<span class="p">};</span>

<span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">MyClass1</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MyClass1</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">myObj1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass1</span><span class="p">();</span>
</pre>
              </td>
            </tr>
          </tbody>
        </table>
      </code></pre>
  </div>
</div>
<p>Our goal is to create an object where there is a publicly available property (<code class="highlighter-rouge">nilUUID</code>) and a publicly available method (<code class="highlighter-rouge">generateUUID()</code>).</p>
<p>We construct a new instance with the <code class="highlighter-rouge">new</code> keyword. If we leave the keyword and then try to call the <code class="highlighter-rouge">myObj1.generateUUID();</code>, we will get a
  <code class="highlighter-rouge">Uncaught TypeError: Cannot read property 'generateUUID' of undefined</code> error.</p>
<p>All the <code class="highlighter-rouge">const</code> and <code class="highlighter-rouge">let</code> methods and properties will be hidden from “outside”.
  So the <code class="highlighter-rouge">myObj1.getNilUUID();</code> will result a <code class="highlighter-rouge">Uncaught TypeError: myObj1.getNilUUID is not a function</code> error. We can call them to be <code class="highlighter-rouge">private</code>.</p>
<p>Every property and method having the <code class="highlighter-rouge">this</code> keyword will be reachable from outside. They are definitely <code class="highlighter-rouge">public</code>. But they are heavily vulnerable which
  I find really disturbing. But that’s the JS way. Try the <code class="highlighter-rouge">document.getElementById = 'sucker';</code> in the console on any website and see what happens. It’s
  also possible to inject new properties and methods into our instance which is also a bit… yuck…</p>
<div class="language-js highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="c1">// Get and set public property</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myObj1</span><span class="p">.</span><span class="nx">nilUUID</span><span class="p">);</span> <span class="c1">// '00000000-0000-0000-0000-000000000000'</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myObj1</span><span class="p">.</span><span class="nx">generateUUID</span><span class="p">(</span><span class="kc">true</span><span class="p">));</span> <span class="c1">// '00000000-0000-0000-0000-000000000000'</span>

<span class="nx">myObj2</span><span class="p">.</span><span class="nx">nilUUID</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Hello World!</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myObj1</span><span class="p">.</span><span class="nx">nilUUID</span><span class="p">);</span> <span class="c1">// 'Hello World!'</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myObj1</span><span class="p">.</span><span class="nx">generateUUID</span><span class="p">(</span><span class="kc">true</span><span class="p">));</span> <span class="c1">// 'Hello World!'</span>

<span class="c1">// BUT!</span>
<span class="nx">myObj1</span><span class="p">.</span><span class="nx">generateUUID</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">I am so sorry</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myObj1</span><span class="p">.</span><span class="nx">generateUUID</span><span class="p">(</span><span class="kc">true</span><span class="p">));</span> <span class="c1">//  Uncaught TypeError: myObj1.generateUUID is not a function</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myObj2</span><span class="p">.</span><span class="nx">generateUUID</span><span class="p">);</span> <span class="c1">// 'I am so sorry'</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<h5 id="pros">Pros:</h5>
<ul>
  <li>It has a cleaner code.</li>
  <li>It’s easier to understand.</li>
  <li>Enforces the <code class="highlighter-rouge">new</code> keyword for instantiation.</li>
</ul>
<h5 id="cons">Cons:</h5>
<ul>
  <li>It is vulnerable: every public method and property can be re-defined.</li>
  <li>It has no support for <code class="highlighter-rouge">get</code>, <code class="highlighter-rouge">set</code> and <code class="highlighter-rouge">static</code> keywords.</li>
  <li>No type check is possible before assigning new value to the public properties.</li>
  <li>It’s possible to add/attach additional properties and methods to the instance.</li>
</ul>
<h4 id="way-2-twisted-thinking-to-protect-the-code">Way 2: twisted thinking to protect the code</h4>
<p>This one is a nasty motherfucker. I found the cons very annoying in the first example, so I tried to figure out, how can I eliminate them.</p>
<p>In this case we start the same way as previously, but then instead of making publicly available properties and methods, we simply
  <strong>return</strong> with an object.</p>
<div class="language-js highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="cm">/**
 * @returns {string|Readonly&lt;{readonly, nilUUID: Object.nilUUID, generateUUID: (function(*=): string)}&gt;}
 * @constructor
 */</span>
<span class="kd">const</span> <span class="nx">MyClass2</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
<span class="p">{</span>
    <span class="cm">/** @type {array} */</span>
    <span class="kd">const</span> <span class="nx">AVAILABLE_CHARACTERS</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz</span><span class="dl">'</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>

    <span class="cm">/** @type {array} */</span>
    <span class="kd">const</span> <span class="nx">uuidTemplate</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">xxxxxxxx-xxxx-!xxx-?xxx-xxxxxxxxxxxx</span><span class="dl">'</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>

    <span class="cm">/** @type {string} */</span>
    <span class="kd">const</span> <span class="nx">uuidVersion</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">4</span><span class="dl">'</span><span class="p">;</span>

    <span class="cm">/**
     * @returns {string}
     */</span>
    <span class="kd">const</span> <span class="nx">getNilUUID</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="dl">'</span><span class="s1">00000000-0000-0000-0000-000000000000</span><span class="dl">'</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="cm">/**
     * Collection of public properties.
     *
     * @type {Object}
     */</span>
    <span class="kd">const</span> <span class="nx">properties</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">nilUUID</span><span class="p">:</span> <span class="nx">getNilUUID</span><span class="p">(),</span>
    <span class="p">};</span>

    <span class="cm">/**
     * Collection of public methods including setters and getters for public properties.
     *
     * @type { {readonly nilUUID: Object.nilUUID, generateUUID: (function(*=): string)} }
     */</span>
    <span class="kd">const</span> <span class="nx">methods</span> <span class="o">=</span> <span class="p">{</span>
        <span class="kd">set</span> <span class="nx">nilUUID</span><span class="p">(</span><span class="nx">newValue</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">newValue</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="dl">'</span><span class="s1">nilUUID must store string value, </span><span class="dl">'</span> <span class="o">+</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">newValue</span><span class="p">)</span> <span class="o">+</span> <span class="dl">'</span><span class="s1"> given.</span><span class="dl">'</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">properties</span><span class="p">.</span><span class="nx">nilUUID</span> <span class="o">=</span> <span class="nx">newValue</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="kd">get</span> <span class="nx">nilUUID</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">properties</span><span class="p">.</span><span class="nx">nilUUID</span><span class="p">;</span>
        <span class="p">},</span>

        <span class="cm">/**
         * Generate and return a valid UUID
         * @see https://en.wikipedia.org/wiki/Universally_unique_identifier
         *
         * @returns {string}
         */</span>
        <span class="na">generateUUID</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">isNilUUID</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">isNilUUID</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">nilUUID</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="kd">let</span> <span class="nx">uuidVariant</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">random</span><span class="p">;</span>
            <span class="kd">const</span> <span class="nx">uuid</span> <span class="o">=</span> <span class="p">[];</span>

            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">uuidTemplate</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">random</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">|</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">16</span><span class="p">;</span>
                <span class="nx">uuidVariant</span> <span class="o">=</span> <span class="p">(</span><span class="nx">random</span> <span class="o">&amp;</span> <span class="mh">0x3</span><span class="p">)</span>  <span class="o">|</span> <span class="mh">0x8</span><span class="p">;</span>

                <span class="nx">uuid</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">uuidTemplate</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
                    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">[^\-\!\?]</span><span class="sr">/</span><span class="p">,</span> <span class="nx">AVAILABLE_CHARACTERS</span><span class="p">[</span><span class="nx">random</span><span class="p">])</span>
                    <span class="c1">// ! is the uuid version</span>
                    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="dl">'</span><span class="s1">!</span><span class="dl">'</span><span class="p">,</span> <span class="nx">uuidVersion</span><span class="p">)</span>
                    <span class="c1">// ? is the high bits of clock sequence according to rfc4122</span>
                    <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="dl">'</span><span class="s1">?</span><span class="dl">'</span><span class="p">,</span> <span class="nx">AVAILABLE_CHARACTERS</span><span class="p">[</span><span class="nx">uuidVariant</span><span class="p">]);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">uuid</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">freeze</span><span class="p">(</span><span class="nx">methods</span><span class="p">);</span>
<span class="p">};</span>

<span class="nb">window</span><span class="p">[</span><span class="dl">'</span><span class="s1">MyClass2</span><span class="dl">'</span><span class="p">]</span> <span class="o">=</span> <span class="nx">MyClass2</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">myObj2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass2</span><span class="p">();</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<p>Our goal is the same: create an object where there is a publicly available property (<code class="highlighter-rouge">nilUUID</code>) and a publicly available method (<code class="highlighter-rouge">generateUUID()</code>).</p>
<p>We construct a new instance with the <code class="highlighter-rouge">new</code> keyword. But unfortunately it’s not mandatory. However, I’d like to use it to keep the illusion.</p>
<p>As previously all the <code class="highlighter-rouge">const</code> and <code class="highlighter-rouge">let</code> methods and properties will be hidden from “outside”. And here’s the twisty thing: we define two objects in the
  private part. One for the “<em>public properties</em>” and one for the “<em>public methods</em>”. Within each object we can reach methods and properties by the <code class="highlighter-rouge">this</code>
  keyword, as we do it in the <code class="highlighter-rouge">generateUUID()</code> method. But for cross-referencing between the <code class="highlighter-rouge">properties</code> and <code class="highlighter-rouge">methods</code> we can’t use the <code class="highlighter-rouge">this</code>.</p>
<p>So why we separate the “<em>public</em>” properties and methods? Because in the end we will freeze the returning <code class="highlighter-rouge">methods</code> object, which means we can’t change
  this object any more. Luckily this does not stand for the contents of Arrays and Objects. In a frozen object we can’t change scalars, but we can
  add/change elements in an array/object. That’s why we collect all the “<em>public</em>” properties separately in an object. And since we can use the <code class="highlighter-rouge">get</code>
  and <code class="highlighter-rouge">set</code> keywords, we can create the illusion of working directly with the public property:</p>
<div class="language-js highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="c1">// Get and set public property</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myObj2</span><span class="p">.</span><span class="nx">nilUUID</span><span class="p">);</span> <span class="c1">// '00000000-0000-0000-0000-000000000000'</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myObj2</span><span class="p">.</span><span class="nx">generateUUID</span><span class="p">(</span><span class="kc">true</span><span class="p">));</span> <span class="c1">// '00000000-0000-0000-0000-000000000000'</span>

<span class="nx">myObj2</span><span class="p">.</span><span class="nx">nilUUID</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Hello World!</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myObj2</span><span class="p">.</span><span class="nx">nilUUID</span><span class="p">);</span> <span class="c1">// 'Hello World!'</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myObj2</span><span class="p">.</span><span class="nx">generateUUID</span><span class="p">(</span><span class="kc">true</span><span class="p">));</span> <span class="c1">// 'Hello World!'</span>

<span class="c1">// AND!</span>
<span class="nx">myObj2</span><span class="p">.</span><span class="nx">generateUUID</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">I am so sorry</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myObj2</span><span class="p">.</span><span class="nx">generateUUID</span><span class="p">(</span><span class="kc">true</span><span class="p">));</span> <span class="c1">// 'Hello World!'</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">myObj2</span><span class="p">.</span><span class="nx">generateUUID</span><span class="p">);</span> <span class="c1">// 'function()...'</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<h5 id="pros-1">Pros</h5>
<ul>
  <li>The public code is in safe. No way to overwrite them.</li>
  <li>It has support for <code class="highlighter-rouge">get</code>, <code class="highlighter-rouge">set</code> and <code class="highlighter-rouge">static</code> keywords.</li>
  <li>With the <code class="highlighter-rouge">set</code> method we can do type check before assignment.</li>
  <li>Not possible to add/attach additional properties and methods.</li>
</ul>
<h5 id="cons-1">Cons</h5>
<ul>
  <li>This is far away from readability.</li>
  <li>It’s difficult to understand.</li>
  <li>Every public, read-write property requires a <code class="highlighter-rouge">set</code> and a <code class="highlighter-rouge">get</code> method.</li>
  <li>The <code class="highlighter-rouge">new</code> keyword is not mandatory.</li>
</ul>
<h3 id="conclusion">Conclusion</h3>
<p>As you can see, in order to eliminate all the negatives from the first solution, I had to sacrifice all the positives from it. But I think it’s worth it,
  because in the end we want to use the code and not read it. And we can still use the <code class="highlighter-rouge">new</code> keyword if we want to.</p>
<p>Readability is not a big price to make our object defended from harmful hands. What do you think? Am I right? Am I wrong? Is this really a
  worst practice?</p>
</div>
<footer class="a-footer">
  <h3 class="a-footer__title">About the author</h3>
  <a class="a-footer__avatar" href="/author/gabor.ivan/index.html"><img src="/author/gabor.ivan/avatar.jpg" alt="Gábor Iván"></a>
  <p class="a-footer__author">
    Hi, my name is Gábor Iván. I am a PHP developer at <a href="https://www.westwing.com" target="_blank">Westwing</a>, but I also like to deal with the Frontend part too. Of course, in a non-professional way.
    <br>
    <a href="/author/gabor.ivan/index.html">Read the full story</a>
  </p>
</footer>
</article>
<aside class="a-comments">
  <header class="a-comments__title">
    <h4>It's time to judge me!</h4>
  </header>
  <div id="commento">
    It seems like that Commento or JavaScript in general is disabled, so no chance to judge me in public. But don't worry, you can
    <a class="mailto" href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#119;&#111;&#114;&#115;&#116;&#46;&#112;&#114;&#97;&#99;&#116;&#105;&#99;&#101;&#46;&#98;&#108;&#111;&#103;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;?subject=Judgement on `Deal with 'public' and 'private' access modifiers in JS`" target="_blank" rel="noopener noreferrer">write me</a>
    your opinions/ideas/suggestions in email. Please don't forget to reference the page in the message.
  </div>
</aside>
</section>
</main>
<footer class="f-footer">
  <p class="f-footer__copyright">
    <small>Copyright © 2020 All rights reserved. Worst Practice</small>
  </p>
</footer>
</body>
</html>