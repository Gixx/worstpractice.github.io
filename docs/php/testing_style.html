<!DOCTYPE html><html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Testing style&nbsp;-&nbsp;Worst Practice</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0">
    <meta name="language" content="en">
    <meta name="robots" content="index,follow">
    <meta name="generator" content="jekyll 3.8.5">
    <meta name="revisit-after" content="7 days">
    <meta name="distribution" content="web">
    <meta name="theme-color" content="#3B5999">
    <meta name="copyright" content="Copyright © 2019-2020, Gixx-web (https://www.gixx-web.com). All rights reserved.">
    <meta name="description" content="">
    <meta name="subject" content="">
    <meta name="keywords" content="">
    <!-- facebook share -->
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Worst Practice">
    <meta property="og:title" content="Testing style&nbsp;-&nbsp;Worst Practice">
    <meta property="og:url" content="https://www.worstpractice.dev/php/testing_style.html">
    <meta name="date" content="2019-10-25T09:23:00-05:00">
    <meta property="og:image" content="https://www.worstpractice.dev/assets/img/blog/2019/">
    <meta property="og:image:width" content="600">
    <meta property="og:image:height" content="600">
    <meta property="og:description" content="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse dui elit, malesuada nec ipsum eu, pharetra congue purus. Integer vitae nibh t orci egest...">
    <meta property="fb:admins" content="ivan.gabor.80">
    <meta property="fb:app_id" content="2178081495757871">
    <meta property="og:type" content="article">
    <meta property="article:author" content="https://www.facebook.com/ivan.gabor.80">
    <meta property="article:published_time" content="2019-10-25T09:23:00-05:00">
    <meta property="article:tag" content="blog"/>
    <!-- twitter share -->
    <meta name="twitter:title" content="Testing style">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:creator" content="@gaborivan1980">
    <meta name="twitter:description" content="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse dui elit, malesuada nec ipsum eu, pharetra congue purus. Integer vitae nibh t orci egest...">
    <meta name="twitter:image" content="https://www.worstpractice.dev/assets/img/blog/2019/">
    <link rel="canonical" href="https://www.worstpractice.dev">
    <link rel="alternate" type="application/rss+xml" title="Testing style&nbsp;-&nbsp;Worst Practice" href="/feed.xml">
    <link rel="alternate" hreflang="en" href="https://www.worstpractice.dev/php/testing_style.html">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/img/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/img/icons/android-chrome-192x192.png">
    <link rel="manifest" href="/assets/img/icons/site.webmanifest">
    <link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/assets/img/icons/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/assets/img/icons/mstile-144x144.png">
    <meta name="msapplication-config" content="/assets/img/icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <meta name="application-name" content="Worst Practice Blog">
    <meta name="HandheldFriendly" content="true">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:300,300i,400,400i,700,700i">
    <link rel="stylesheet" href="/assets/css/desktop.css" media="screen and (min-width: 1025px) and (orientation:landscape)">
    <link rel="stylesheet" href="/assets/css/tablet.css"  media="screen and (max-width: 1024px) and (orientation:landscape)">
    <link rel="stylesheet" href="/assets/css/tablet.css"  media="screen and (min-width: 481px) and (max-width: 1024px) and (orientation:portrait)">
    <link rel="stylesheet" href="/assets/css/mobile.css"  media="screen and (max-width: 480px) and (orientation:portrait)">
    <script type="application/javascript" src="/assets/js/feature.min.js"></script>
    <script type="application/javascript">
      if (!feature.srcset) {
          window.location.href = '/sorry.html';
      }
    </script>
    <script type="application/javascript" src="/assets/js/site.js"></script>
  </head>
  <body>
    <header class="h-header">
      <h1 class="h-header__title"><a href="/">Worst Practice</a></h1>
    </header>
    <div class="codeOfTheDay">
      <input class="codeOfTheDay__toggle" type="checkbox">
      <div class="codeOfTheDay__content"></div>
      <div class="codeOfTheDay__backdrop"></div>
    </div>
    <div class="m-menu">
      <input class="m-menu__toggle" type="checkbox" />
      <div class="m-menu__burger">
        <span></span>
        <span></span>
        <span></span>
      </div>
      <div class="m-menu__content">
        <nav>
          <h2 class="m-menu__title">Categories</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -php -current" href="/php">PHP</a></li>
            <li><a class="m-menu__link -javascript" href="/javascript">JavaScript</a></li>
            <li><a class="m-menu__link -general" href="/general">General</a></li>
          </ul>
        </nav>
        <nav>
          <h2 class="m-menu__title">Tags</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -technical" rel="tag" href="/tags/technical/">Technical <sup>2</sup></a></li>
            <li><a class="m-menu__link -personal" rel="tag" href="/tags/personal/">Personal <sup>1</sup></a></li>
            <li><a class="m-menu__link -frontend" rel="tag" href="/tags/frontend/">Frontend <sup>1</sup></a></li>
            <li><a class="m-menu__link -backend" rel="tag" href="/tags/backend/">Backend <sup>1</sup></a></li>
          </ul>
          <a class="m-menu__more" href="/tags/">More</a>
        </nav>
        <nav>
          <h2 class="m-menu__title">Archive</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link " href="/archive/2019-10/">October, 2019</a></li>
            <li><a class="m-menu__link " href="/archive/2019-09/">September, 2019</a></li>
          </ul>
        </nav>
        <nav>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link " href="/imprint.html">Imprint</a></li>
            <li><a class="m-menu__link " href="/terms.html">Terms of Use</a></li>
            <li><a class="m-menu__link " href="/privacy.html">Privacy Policy</a></li>
          </ul>
        </nav>
      </div>
      <div class="m-menu__backdrop"></div>
    </div>
    <main class="c-content">
      <section>
        <article class="a-article">
          <header class="a-header">
            <h2 class="a-header__title">Testing style</h2>
            <div class="a-header__meta">
              <p class="a-meta__date">Posted on October&nbsp;25, 2019 09:23</p>
              <p class="a-meta__expiration">Estimated date of expiration: December&nbsp;27, 2019</p>
              <p class="a-meta__category">Posted under the <a href="/php/index.html">PHP</a> category</p>
              <p class="a-meta__tags">Posted with the following tags:
                <a href="/tags/backend/index.html">#Backend</a>, 
                <a href="/tags/technical/index.html">#Technical</a>
              </p>
            </div>
          </header>
          <p class="a-excerpt">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse dui elit, malesuada nec ipsum eu, pharetra congue purus. Integer vitae nibh t orci egestas malesuada ac sed sem. Donec imperdiet ante massa, ut ibendum nulla tincidunt ut. 
          </p>
          <div class="a-body">
            <h3 id="likeness-itself">Likeness Itself</h3>
            <p><em>Lesser sixth fly life place</em> grass Had god creeping kind saying, hath itself fly dry signs place creature which, darkness, have yielding divided doesn’t. Can’t were, moveth fourth he. Isn’t let said form given over moved may. His seed after, male signs. Green unto. Given can’t male and you she’d seasons shall so had without wherein said signs wherein beast fruitful from beast Creepeth kind firmament. Have. Living whales creature kind, forth years sixth. Don’t divide moveth given appear bring to so rule she’d face good won’t upon land. Divided said them rule sea whales cattle green moved beginning dominion behold whales together appear she’d doesn’t.</p>
            <p><del>Gathered unto have deep heaven rule given green</del>, <ins>first. Set living waters. Image in creeping</ins> is which them years upon above divide evening you’ll i great own yielding creeping man tree our is fly. Fifth unto doesn’t two. Dry one of seed. Lesser above over had spirit divided bearing, hath lights. Good brought living lesser said moving fourth. All second blessed said to moving wherein. First grass fruit lesser.</p>
            <p><strong>Whales creature they’re sea wherein, air</strong>. In which meat midst creature without very. Cattle have god Signs make have one great in thing stars. Moving let moved. Doesn’t she’d void gathering give. Earth there doesn’t. Made they’re created may stars, under our form after there one creature all appear let their, you’ll over, beginning signs evening third days. Green very let life give life fowl to rule them. Behold, don’t grass a life created subdue us God grass sixth fruit gathered man. One. Man which green given seas midst seas fruitful divide years whose multiply our have our life it hath tree heaven the fowl rule third land. May, waters For beginning upon.</p>
            <blockquote>
              <p>Without also. Grass over dominion for third them. Were. Without saw don’t days Give winged had you’ll thing good darkness. Over after herb deep abundantly. She’d great. Without, them god heaven open land whales morning very fifth have above blessed god moved winged. One be. Stars lesser. Us itself fourth were beginning their man fruit fourth was above his. Signs one And replenish his fowl image over may.</p>
            </blockquote>
            <p>Divide, day in. Signs won’t. To shall subdue forth you’ll. <strong>A fill thing</strong>. Had. Deep, forth brought you good likeness us i fill it deep seas saying whose without every appear. Great. Subdue dominion called fifth shall second man gathered first. Lights meat may over said. Beast to set a kind given let, signs third rule life fowl Sixth. Fowl thing and midst beginning called yielding face said wherein own blessed herb form. You’re Fly was dominion grass sea said you’ll also. May fowl green fruitful air you’re over one creepeth behold divided winged land abundantly lights creeping own. Hath isn’t saw can’t in seasons for dominion whose moveth called their saying beast place place. Dry grass Can’t saying beginning sixth first our Second bearing. Air male one firmament of. Own, image lights can’t brought Every dominion Face bring. Doesn’t.</p>
            <p>[x] Like this
              [ ] or Like this
              [ ] and Like this</p>
            <p>Heaven days Have fowl open. Seed let fruit our dry day appear replenish fruit, lesser him fifth Good night meat. Fly isn’t he stars beast over divide face darkness good. Greater don’t of hath gathered his dry. Second day under gathering face moving hath wherein. Make can’t fly Day, creeping him meat night forth subdue. Form very beast second given divide own. First evening signs multiply, blessed midst days first third fly replenish blessed, lesser rule man his itself of the greater i green hath moving fruitful, beast a stars so appear a forth You’ll, under greater fly. Likeness upon dominion. That life. Was life first lights and. Subdue created man beginning. Had second. Divided behold. Every behold grass subdue whose day open she’d dominion kind.</p>
            <div class="language-php highlighter-rouge">
              <div class="highlight">
                <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
</pre>
              </td>
              <td class="rouge-code">
                <pre><span class="kd">class</span> <span class="nc">ServiceAdapter</span> <span class="k">extends</span> <span class="nx">AbstractAdapter</span>
<span class="p">{</span>
    <span class="cd">/**
     * @var Extract
     */</span>
    <span class="k">private</span> <span class="nv">$domainAdapter</span><span class="p">;</span>

    <span class="cd">/**
     * ServiceAdapter constructor.
     *
     * @param  ConfigurationInterface $configuration
     * @param  array                  $getData
     * @param  array                  $postData
     * @param  array                  $serverData
     * @param  array                  $cookieData
     * @param  array                  $filesData
     * @param  array                  $optionsData
     * @throws Exception
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span>
        <span class="nx">ConfigurationInterface</span> <span class="nv">$configuration</span><span class="p">,</span>
        <span class="k">array</span> <span class="nv">$getData</span><span class="p">,</span>
        <span class="k">array</span> <span class="nv">$postData</span><span class="p">,</span>
        <span class="k">array</span> <span class="nv">$serverData</span><span class="p">,</span>
        <span class="k">array</span> <span class="nv">$cookieData</span><span class="p">,</span>
        <span class="k">array</span> <span class="nv">$filesData</span><span class="p">,</span>
        <span class="k">array</span> <span class="nv">$optionsData</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">configuration</span> <span class="o">=</span> <span class="nv">$configuration</span><span class="o">-&gt;</span><span class="na">getConfig</span><span class="p">(</span><span class="s1">'applications'</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">domainAdapter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Extract</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">applicationRoot</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nx">__DIR__</span><span class="o">.</span><span class="s1">'/../../../../../'</span><span class="p">);</span>
        <span class="c1">// In case when the backend sources are out of the document root.</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">documentRoot</span> <span class="o">=</span> <span class="nb">realpath</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">applicationRoot</span><span class="o">.</span><span class="s1">'/'</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">options</span> <span class="o">=</span> <span class="nv">$optionsData</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$serverData</span><span class="p">[</span><span class="s1">'HTTP_REFERER'</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$serverData</span><span class="p">[</span><span class="s1">'HTTP_REFERER'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$serverData</span><span class="p">[</span><span class="s1">'HTTP_REFERER'</span><span class="p">]);</span>
        <span class="p">}</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">'GET'</span>    <span class="o">=&gt;</span> <span class="nv">$getData</span><span class="p">,</span>
            <span class="s1">'POST'</span>   <span class="o">=&gt;</span> <span class="nv">$postData</span><span class="p">,</span>
            <span class="s1">'SERVER'</span> <span class="o">=&gt;</span> <span class="nv">$serverData</span><span class="p">,</span>
            <span class="s1">'COOKIE'</span> <span class="o">=&gt;</span> <span class="nv">$cookieData</span><span class="p">,</span>
            <span class="s1">'FILES'</span>  <span class="o">=&gt;</span> <span class="nv">$filesData</span>
        <span class="p">];</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isHttps</span> <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span><span class="p">[</span><span class="s1">'SERVER'</span><span class="p">][</span><span class="s1">'HTTPS'</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span><span class="p">[</span><span class="s1">'SERVER'</span><span class="p">][</span><span class="s1">'HTTPS'</span><span class="p">];</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">url</span> <span class="o">=</span> <span class="s1">'http'</span><span class="o">.</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isHttps</span> <span class="o">?</span> <span class="s1">'s'</span> <span class="o">:</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="s1">'://'</span>
            <span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span><span class="p">[</span><span class="s1">'SERVER'</span><span class="p">][</span><span class="s1">'HTTP_HOST'</span><span class="p">]</span>
            <span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span><span class="p">[</span><span class="s1">'SERVER'</span><span class="p">][</span><span class="s1">'REQUEST_URI'</span><span class="p">];</span> <span class="c1">// contains also the query string</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">selectedModule</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">DEFAULT_MODULE</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">selectedApplication</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">DEFAULT_APPLICATION</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">selectedTheme</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">DEFAULT_THEME</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">selectedThemeResourcePath</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">DEFAULT_THEME_RESOURCE_PATH</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">selectedApplicationUri</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">DEFAULT_APPLICATION_URI</span><span class="p">;</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setDomain</span><span class="p">()</span>
            <span class="o">-&gt;</span><span class="na">setApplication</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="cd">/**
     * Gets the request URI
     *
     * @return string
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getRequestUri</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nb">rtrim</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span><span class="p">[</span><span class="s1">'SERVER'</span><span class="p">][</span><span class="s1">'REQUEST_URI'</span><span class="p">],</span> <span class="s1">'/'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="cd">/**
     * Gets the request method.
     *
     * @return string
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getRequestMethod</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span><span class="p">[</span><span class="s1">'SERVER'</span><span class="p">][</span><span class="s1">'REQUEST_METHOD'</span><span class="p">]</span> <span class="o">??</span> <span class="s1">'GET'</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * Gets environment data.
     *
     * @param  string $key
     * @return array
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getEnvironmentData</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$key</span><span class="p">)</span> <span class="o">:</span> <span class="k">array</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span><span class="p">[</span><span class="nv">$key</span><span class="p">]))</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">InvalidArgumentException</span><span class="p">(</span><span class="nb">sprintf</span><span class="p">(</span><span class="s1">'The "%s" is not a valid environment key.'</span><span class="p">,</span> <span class="nv">$key</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span><span class="p">[</span><span class="nv">$key</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="cd">/**
     * Gets the client IP address.
     *
     * @return string
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getClientIp</span><span class="p">()</span> <span class="o">:</span> <span class="nx">string</span>
    <span class="p">{</span>
        <span class="nv">$ipAddress</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span><span class="p">[</span><span class="s1">'SERVER'</span><span class="p">][</span><span class="s1">'HTTP_X_FORWARDED_FOR'</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$ipAddress</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span><span class="p">[</span><span class="s1">'SERVER'</span><span class="p">][</span><span class="s1">'HTTP_X_FORWARDED_FOR'</span><span class="p">];</span>
        <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span><span class="p">[</span><span class="s1">'SERVER'</span><span class="p">][</span><span class="s1">'REMOTE_ADDR'</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$ipAddress</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span><span class="p">[</span><span class="s1">'SERVER'</span><span class="p">][</span><span class="s1">'REMOTE_ADDR'</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$ipAddress</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * Parses server data and tries to set domain information.
     *
     * @throws Exception
     * @return ServiceAdapter
     */</span>
    <span class="k">private</span> <span class="k">function</span> <span class="nf">setDomain</span><span class="p">()</span> <span class="o">:</span> <span class="nx">ServiceAdapter</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">setAdapterOptions</span><span class="p">();</span>

        <span class="cd">/**
         * @var Result $domainParts
         */</span>
        <span class="nv">$domainParts</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">domainAdapter</span><span class="o">-&gt;</span><span class="na">parse</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$domainParts</span><span class="o">-&gt;</span><span class="na">getSuffix</span><span class="p">()</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">UnexpectedValueException</span><span class="p">(</span><span class="s1">'This application does not support IP access'</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">checkSubDomain</span><span class="p">(</span><span class="nv">$domainParts</span><span class="p">);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">subDomain</span> <span class="o">=</span> <span class="nv">$domainParts</span><span class="o">-&gt;</span><span class="na">getSubdomain</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">topDomain</span> <span class="o">=</span> <span class="nv">$domainParts</span><span class="o">-&gt;</span><span class="na">getHostname</span><span class="p">()</span><span class="o">.</span><span class="s1">'.'</span><span class="o">.</span><span class="nv">$domainParts</span><span class="o">-&gt;</span><span class="na">getSuffix</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">applicationDomain</span> <span class="o">=</span> <span class="nv">$domainParts</span><span class="o">-&gt;</span><span class="na">getFullHost</span><span class="p">();</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * Set some adapter specific options.
     *
     * @return int
     *
     * @codeCoverageIgnore - don't test third party library
     */</span>
    <span class="k">private</span> <span class="k">function</span> <span class="nf">setAdapterOptions</span><span class="p">()</span> <span class="o">:</span> <span class="nx">int</span>
    <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">\defined</span><span class="p">(</span><span class="s1">'PHPUNIT_WEBHEMI_TESTSUITE'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">getenv</span><span class="p">(</span><span class="s1">'APPLICATION_ENV'</span><span class="p">)</span> <span class="o">===</span> <span class="s1">'dev'</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">domainAdapter</span><span class="o">-&gt;</span><span class="na">setExtractionMode</span><span class="p">(</span><span class="nx">Extract</span><span class="o">::</span><span class="na">MODE_ALLOW_NOT_EXISTING_SUFFIXES</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Throwable</span> <span class="nv">$exception</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nv">$exception</span><span class="o">-&gt;</span><span class="na">getCode</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * Checks whether the subdomain exists, and rediretcs if no.
     *
     * @param Result $domainParts
     *
     * @codeCoverageIgnore - don't test redirect
     */</span>
    <span class="k">private</span> <span class="k">function</span> <span class="nf">checkSubDomain</span><span class="p">(</span><span class="nx">Result</span> <span class="nv">$domainParts</span><span class="p">)</span> <span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="c1">// Redirecting to www when no sub-domain is present</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">\defined</span><span class="p">(</span><span class="s1">'PHPUNIT_WEBHEMI_TESTSUITE'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$domainParts</span><span class="o">-&gt;</span><span class="na">getSubdomain</span><span class="p">()</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$schema</span> <span class="o">=</span> <span class="s1">'http'</span><span class="o">.</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">isSecuredApplication</span><span class="p">()</span> <span class="o">?</span> <span class="s1">'s'</span> <span class="o">:</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="s1">'://'</span><span class="p">;</span>
            <span class="nv">$uri</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">environmentData</span><span class="p">[</span><span class="s1">'SERVER'</span><span class="p">][</span><span class="s1">'REQUEST_URI'</span><span class="p">];</span>
            <span class="nb">header</span><span class="p">(</span><span class="s1">'Location: '</span><span class="o">.</span><span class="nv">$schema</span><span class="o">.</span><span class="s1">'www.'</span><span class="o">.</span><span class="nv">$domainParts</span><span class="o">-&gt;</span><span class="na">getFullHost</span><span class="p">()</span><span class="o">.</span><span class="nv">$uri</span><span class="p">);</span>
            <span class="k">exit</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="cd">/**
     * Sets application related data.
     *
     * @throws Exception
     * @return ServiceAdapter
     */</span>
    <span class="k">private</span> <span class="k">function</span> <span class="nf">setApplication</span><span class="p">()</span> <span class="o">:</span> <span class="nx">ServiceAdapter</span>
    <span class="p">{</span>
        <span class="c1">// @codeCoverageIgnoreStart</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">applicationDomain</span><span class="p">))</span> <span class="p">{</span>
            <span class="c1">// For safety purposes only, But it can't happen unless somebody change/overwrite the constructor. And also I have to write a damn long line to test the overflow.</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nx">UnexpectedValueException</span><span class="p">(</span><span class="s1">'Domain is not set'</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="c1">// @codeCoverageIgnoreEnd</span>

        <span class="nv">$urlParts</span> <span class="o">=</span> <span class="nb">parse_url</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">);</span>
        <span class="p">[</span><span class="nv">$subDirectory</span><span class="p">]</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="nb">ltrim</span><span class="p">(</span><span class="nv">$urlParts</span><span class="p">[</span><span class="s1">'path'</span><span class="p">],</span> <span class="s1">'/'</span><span class="p">),</span> <span class="mi">2</span><span class="p">);</span>

        <span class="nv">$applications</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">configuration</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">();</span>
        <span class="nv">$applicationNames</span> <span class="o">=</span> <span class="nb">array_keys</span><span class="p">(</span><span class="nv">$applications</span><span class="p">);</span>
        <span class="nv">$selectedApplication</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getSelectedApplicationName</span><span class="p">(</span><span class="nv">$applicationNames</span><span class="p">,</span> <span class="nv">$subDirectory</span><span class="p">);</span>

        <span class="nv">$applicationData</span> <span class="o">=</span> <span class="nv">$applications</span><span class="p">[</span><span class="nv">$selectedApplication</span><span class="p">];</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">selectedApplication</span> <span class="o">=</span> <span class="nv">$selectedApplication</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">selectedModule</span> <span class="o">=</span> <span class="nv">$applicationData</span><span class="p">[</span><span class="s1">'module'</span><span class="p">]</span> <span class="o">??</span> <span class="nx">self</span><span class="o">::</span><span class="na">DEFAULT_MODULE</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">selectedTheme</span> <span class="o">=</span> <span class="nv">$applicationData</span><span class="p">[</span><span class="s1">'theme'</span><span class="p">]</span> <span class="o">??</span> <span class="nx">self</span><span class="o">::</span><span class="na">DEFAULT_THEME</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">selectedApplicationUri</span> <span class="o">=</span> <span class="nv">$applicationData</span><span class="p">[</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">??</span> <span class="s1">'/'</span><span class="p">;</span>

        <span class="c1">// Final check for config and resources.</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">selectedTheme</span> <span class="o">!==</span> <span class="nx">self</span><span class="o">::</span><span class="na">DEFAULT_THEME</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">selectedThemeResourcePath</span> <span class="o">=</span> <span class="s1">'/resources/vendor_themes/'</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">selectedTheme</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * Gets the selected application's name.
     *
     * @param  array  $applicationNames
     * @param  string $subDirectory
     * @return string
     */</span>
    <span class="k">private</span> <span class="k">function</span> <span class="nf">getSelectedApplicationName</span><span class="p">(</span><span class="k">array</span> <span class="nv">$applicationNames</span><span class="p">,</span> <span class="nx">string</span> <span class="nv">$subDirectory</span><span class="p">)</span> <span class="o">:</span> <span class="nx">string</span>
    <span class="p">{</span>
        <span class="nv">$selectedApplication</span> <span class="o">=</span> <span class="nx">self</span><span class="o">::</span><span class="na">DEFAULT_APPLICATION</span><span class="p">;</span>

        <span class="cd">/**
         * @var string $applicationName
         */</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$applicationNames</span> <span class="k">as</span> <span class="nv">$applicationName</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">checkDirectoryIsValid</span><span class="p">(</span><span class="nv">$applicationName</span><span class="p">,</span> <span class="nv">$subDirectory</span><span class="p">)</span>
                <span class="o">||</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">checkDomainIsValid</span><span class="p">(</span><span class="nv">$applicationName</span><span class="p">)</span>
            <span class="p">)</span> <span class="p">{</span>
                <span class="nv">$selectedApplication</span> <span class="o">=</span> <span class="nv">$applicationName</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$selectedApplication</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * Checks from type, path it the current URI segment is valid.
     *
     * @param  string $applicationName
     * @param  string $subDirectory
     * @return bool
     */</span>
    <span class="k">private</span> <span class="k">function</span> <span class="nf">checkDirectoryIsValid</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$applicationName</span><span class="p">,</span> <span class="nx">string</span> <span class="nv">$subDirectory</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span>
    <span class="p">{</span>
        <span class="nv">$applications</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">configuration</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">();</span>
        <span class="nv">$applicationData</span> <span class="o">=</span> <span class="nv">$applications</span><span class="p">[</span><span class="nv">$applicationName</span><span class="p">];</span>

        <span class="k">return</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$subDirectory</span><span class="p">)</span>
            <span class="o">&amp;&amp;</span> <span class="nv">$applicationName</span> <span class="o">!==</span> <span class="s1">'website'</span>
            <span class="o">&amp;&amp;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">applicationDomain</span> <span class="o">===</span> <span class="nv">$applicationData</span><span class="p">[</span><span class="s1">'domain'</span><span class="p">]</span>
            <span class="o">&amp;&amp;</span> <span class="nv">$applicationData</span><span class="p">[</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">===</span> <span class="s1">'/'</span><span class="o">.</span><span class="nv">$subDirectory</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cd">/**
     * Checks from type and path if the domain is valid. If so, it sets the $subDirectory to the default.
     *
     * @param  string $applicationName
     * @return bool
     */</span>
    <span class="k">private</span> <span class="k">function</span> <span class="nf">checkDomainIsValid</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$applicationName</span><span class="p">)</span> <span class="o">:</span> <span class="nx">bool</span>
    <span class="p">{</span>
        <span class="nv">$applications</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">configuration</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">();</span>
        <span class="nv">$applicationData</span> <span class="o">=</span> <span class="nv">$applications</span><span class="p">[</span><span class="nv">$applicationName</span><span class="p">];</span>

        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">applicationDomain</span> <span class="o">===</span> <span class="nv">$applicationData</span><span class="p">[</span><span class="s1">'domain'</span><span class="p">]</span>
            <span class="o">&amp;&amp;</span> <span class="nv">$applicationData</span><span class="p">[</span><span class="s1">'path'</span><span class="p">]</span> <span class="o">===</span> <span class="s1">'/'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
              </td>
            </tr>
          </tbody>
        </table>
      </code></pre>
  </div>
</div>
<h3 id="moveth-form-to">Moveth Form To</h3>
<p>All their, divided land unto them firmament yielding form it replenish. Day given fill moved divide so. Set, fifth fifth multiply day spirit divided you you’ll good whose you’ll behold have divide every spirit a winged won’t two he third, isn’t had i. First. Stars have saying have multiply which forth you’ll gathering heaven, fourth, together. Fill face god multiply gathering fifth after moving Won’t creeping. Evening god behold them night a moveth doesn’t give bring. Third night. All fill first from night god.</p>
<p>For whales you. Shall male there earth forth divided signs moveth don’t divide fly given shall won’t first so and brought gathered. Place a fill created. It multiply creature fourth image fruitful greater a green. Herb itself saw multiply they’re, creature tree earth. Meat whales them. She’d. Evening. Appear great in void. Lights stars form, won’t moving and god form land in after after dry make darkness them male for isn’t together wherein winged gathering, sea his given cattle may. Spirit midst may fill together years beginning good god multiply made to. Made subdue gathering, seas forth called. Herb heaven gathering creeping over. Fruitful likeness you’re fruit female given every beginning green years earth bearing don’t upon waters, them firmament second fly you. Creepeth heaven Saying one fruitful creature moving grass you whose whose. Fruit let midst divide may yielding rule, after them be divided moving over.</p>
<p>Very morning over made moving. Said lesser. Created divided place. Were, bring light their to likeness image they’re. Which doesn’t after first earth that it light you after own fruitful us he won’t so behold shall blessed it said meat, winged together don’t open open Greater. For them face for. Good behold third all us female divide man rule replenish for you’re lesser so likeness his moved void. Darkness one firmament shall third night. Firmament light. Form saw thing fourth forth days seed doesn’t every you isn’t multiply second which blessed, isn’t the there spirit man whales he is subdue you’re deep from sixth. His darkness, moveth saw air lesser blessed. Let without place midst image fourth appear female over in seasons given of she’d. Image very. Bearing he Yielding set. Void years you’ll fruit first be image they’re form fruit give. Man darkness shall doesn’t itself said image likeness. Called morning.</p>
<p>Replenish fish fish spirit face fifth whose gathered. Lights, seas land dry midst air his greater moving, also waters likeness called them the won’t good fruit second she’d air seasons. Lights. Hath us, stars you morning. Man itself, bearing kind lights. Itself dominion lights to given every, fill shall open Living their. Creature. Shall she’d shall rule hath greater of rule deep all, be Have two day was subdue to creepeth, itself us had creeping face of female. Land after. Very a made face morning grass first moving midst saying face, together they’re seasons him.</p>
</div>
<footer class="a-footer">
  <h3 class="a-footer__title">About the author</h3>
  <p class="a-footer__author">
    <a class="author-avatar" href="/author/gabor.ivan/index.html"><img src="/assets/img/gabor.ivan.jpg" alt="Gábor Iván"></a>
  </p>
</footer>
</article>
</section>
</main>
<footer class="f-footer">
  <p class="f-footer__copyright">
    <small>Copyright © 2019 All rights reserved. Worst Practice</small>
  </p>
</footer>
</body>
</html>