<!DOCTYPE html><html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Advent of Code - Day 12&nbsp;-&nbsp;Worst Practice
    </title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0">
    <meta name="language" content="en">
    <meta name="robots" content="index,follow">
    <meta name="generator" content="jekyll 3.8.5">
    <meta name="revisit-after" content="7 days">
    <meta name="distribution" content="web">
    <meta name="copyright" content="Copyright © 2022 All rights reserved. Worst Practice.">
    <meta name="description" content="
">
    <meta name="subject" content="">
    <meta name="keywords" content="PHP, Advent of Code">
    <!-- facebook share -->
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Worst Practice">
    <meta property="og:title" content="Advent of Code - Day 12&nbsp;-&nbsp;Worst Practice
">
    <meta property="og:url" content="https://www.worstpractice.dev/backend/advent-of-code-day-12">
    <meta name="date" content="2022-12-12T13:45:00+00:00">
    <meta property="og:image" content="https://www.worstpractice.dev/assets/img/blog/2022/backend/advent-of-code-day-12/advent-12.jpg">
    <meta property="og:image:width" content="600">
    <meta property="og:image:height" content="600">
    <meta property="og:description" content="I would climb the mountain high, so high, to be able to touch the sky.">
    <meta property="fb:admins" content="ivan.gabor.80">
    <meta property="fb:app_id" content="2178081495757871">
    <meta property="og:type" content="article">
    <meta property="article:author" content="https://www.facebook.com/ivan.gabor.80">
    <meta property="article:published_time" content="2022-12-12T13:45:00+00:00">
    <meta property="article:tag" content="blog"/>
    <!-- twitter share -->
    <meta name="twitter:title" content="Advent of Code - Day 12">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:creator" content="@gaborivan1980">
    <meta name="twitter:description" content="I would climb the mountain high, so high, to be able to touch the sky.">
    <meta name="twitter:image" content="https://www.worstpractice.dev/assets/img/blog/2022/backend/advent-of-code-day-12/advent-12_600x600.jpg">
    <link rel="canonical" href="https://www.worstpractice.dev">
    <link rel="alternate" type="application/rss+xml" title="Advent of Code - Day 12&nbsp;-&nbsp;Worst Practice
" href="/feed.xml">
    <link rel="alternate" hreflang="en" href="https://www.worstpractice.dev/backend/advent-of-code-day-12">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/img/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/img/icons/android-chrome-192x192.png">
    <link rel="manifest" href="/assets/img/icons/site.webmanifest">
    <link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg" color="#C23F2F">
    <link rel="shortcut icon" href="/assets/img/icons/favicon.ico">
    <meta name="msapplication-TileColor" content="#C23F2F">
    <meta name="msapplication-TileImage" content="/assets/img/icons/mstile-144x144.png">
    <meta name="msapplication-config" content="/assets/img/icons/browserconfig.xml">
    <meta name="theme-color" content="#C23F2F">
    <meta name="application-name" content="Worst Practice Blog">
    <meta name="HandheldFriendly" content="true">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#C23F2F">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:300,300i,400,400i,700,700i">
    <link rel="stylesheet" href="/assets/css/site.css">
    <script type="application/javascript" src="/assets/js/feature.min.js"></script>
    <script type="application/javascript">
      if (!feature.srcset) {
          window.location.href = '/sorry.html';
      }
    </script>
    <script type="application/javascript" src="/assets/js/site.min.js"></script>
  </head>
  <body>
    <header class="h-header">
      <h1 class="h-header__title"><a href="/">Worst Practice</a></h1>
    </header>
    <div class="codeOfTheDay">
      <input class="codeOfTheDay__toggle" type="checkbox">
      <div class="codeOfTheDay__content"></div>
      <div class="codeOfTheDay__monitor"></div>
      <div class="codeOfTheDay__backdrop"></div>
    </div>
    <div class="m-menu">
      <div class="m-menu__burger">
        <span></span>
      </div>
      <input class="m-menu__toggle" type="checkbox" />
      <div class="m-menu__content">
        <nav>
          <h2 class="m-menu__title">Worst Practice</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -home" href="/">Home</a></li>
          </ul>
        </nav>
        <nav>
          <h2 class="m-menu__title">Categories</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -backend -current" href="/backend">Backend</a></li>
            <li><a class="m-menu__link -devenv" href="/devenv">Development Environment</a></li>
            <li><a class="m-menu__link -frontend" href="/frontend">Frontend</a></li>
            <li><a class="m-menu__link -general
" href="/general
">General</a></li>
          </ul>
        </nav>
        <nav>
          <h2 class="m-menu__title">Tags</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -php" rel="tag" href="/tags/php/">PHP <sup>19</sup></a></li>
            <li><a class="m-menu__link -advent" rel="tag" href="/tags/advent/">Advent <sup>14</sup></a></li>
            <li><a class="m-menu__link -php74" rel="tag" href="/tags/php74/">PHP 7.4 <sup>4</sup></a></li>
          </ul>
          <a class="m-menu__link -more" href="/tags/">More</a>
        </nav>
        <nav>
          <h2 class="m-menu__title">Archive</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link " href="/archive/2022-12/">December, 2022</a></li>
            <li><a class="m-menu__link " href="/archive/2022-11/">November, 2022</a></li>
            <li><a class="m-menu__link " href="/archive/2022-10/">October, 2022</a></li>
          </ul>
          <a class="m-menu__link -more" href="/archive/">More</a>
        </nav>
        <nav>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link " href="/imprint.html">Imprint</a></li>
            <li><a class="m-menu__link " href="/terms.html">Terms of Use</a></li>
            <li><a class="m-menu__link " href="/privacy.html">Privacy Policy</a></li>
          </ul>
        </nav>
      </div>
      <div class="m-menu__backdrop"></div>
    </div>
    <main class="c-content">
      <section class="c-content__article">
        <article class="a-article">
          <header class="a-header">
            <h2 class="a-header__title">Advent of Code - Day 12</h2>
            <div class="a-header__meta">
              <p class="a-meta__date">Posted on December&nbsp;12, 2022 @ 13:45
              </p>
              <p class="a-meta__category">Posted under the <a href="/backend/index.html">Backend</a> category</p>
              <p class="a-meta__level">Level: intermediate</p>
              <p class="a-meta__tags">Posted with the following tags:
                <a href="/tags/advent/index.html">#Advent</a>, 
                <a href="/tags/php/index.html">#PHP</a>
              </p>
            </div>
          </header>
          <p class="a-excerpt">
            I would climb the mountain high, so high, to be able to touch the sky.
          </p>
          <figure class="a-illustration">
            <img class="a-illustration__image" src="/assets/img/post-illustration-placeholder.png" data-src="/assets/img/blog/2022/backend/advent-of-code-day-12/advent-12.jpg" alt="Advent of Code - Day 12">
            <figcaption class="a-illustration__caption">Calendar icon by <a target="_blank" rel="noopener" href="https://pixabay.com/users/pinwhalestock-13691058/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4623521">Kevin Sanderson</a> from <a target="_blank" rel="noopener" href="https://pixabay.com//?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4623521">Pixabay</a></figcaption>
          </figure>
          <div class="a-body">
            <p><a href="https://adventofcode.com/2022/day/12" rel="noopener" target="_blank">Today’s puzzle</a> in short: <span lang="jp" title="Climb mount Niitaka">新高山登れ</span></p>
            <h3 id="the-input-data">The input data</h3>
            <p>We get a file with a bunch of alphabetical characters:</p>
            <ul>
              <li>The input has 41 lines and 71 columns</li>
              <li>Every character represents the height of the surface:
                <ul>
                  <li><code class="language-plaintext highlighter-rouge">a</code> is the lowest</li>
                  <li><code class="language-plaintext highlighter-rouge">z</code> is the highest</li>
                  <li><code class="language-plaintext highlighter-rouge">b</code> is 1 level higher than <code class="language-plaintext highlighter-rouge">a</code></li>
                  <li><code class="language-plaintext highlighter-rouge">c</code> is 1 level higher than <code class="language-plaintext highlighter-rouge">b</code></li>
                  <li>…</li>
                  <li><code class="language-plaintext highlighter-rouge">z</code> is 1 level higher than <code class="language-plaintext highlighter-rouge">y</code></li>
                </ul>
              </li>
              <li><code class="language-plaintext highlighter-rouge">S</code> represents the start point</li>
              <li><code class="language-plaintext highlighter-rouge">E</code> represents the end point</li>
            </ul>
            <h4 id="game-rules">Game rules</h4>
            <p>One step at a time to a neighboring field only when:</p>
            <ul>
              <li>the neighbor field is maximum one level higher</li>
              <li>… or equal to the current one</li>
              <li>or lower (with any level) then the current one</li>
            </ul>
            <p>Our task is get from <code class="language-plaintext highlighter-rouge">S</code> to <code class="language-plaintext highlighter-rouge">E</code> in the shortest possible way.</p>
            <h3 id="the-data-model">The data model</h3>
            <p>Since part one and two are almost the same (again), I start with the common part. First we need to define a class to represent a
              field on the height map and also store the neighbor fields:</p>
            <div class="language-php highlighter-rouge">
              <div class="highlight">
                <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre>
              </td>
              <td class="rouge-code">
                <pre><span class="kd">class</span> <span class="nc">Position</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">?Position</span> <span class="nv">$top</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">?Position</span> <span class="nv">$right</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">?Position</span> <span class="nv">$bottom</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">?Position</span> <span class="nv">$left</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">bool</span> <span class="nv">$isVisited</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">?int</span> <span class="nv">$distance</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="kt">public</span> <span class="n">int</span> <span class="nv">$row</span><span class="p">,</span> <span class="kt">public</span> <span class="n">int</span> <span class="nv">$col</span><span class="p">,</span> <span class="kt">public</span> <span class="n">int</span> <span class="nv">$height</span><span class="p">,</span> <span class="kt">public</span> <span class="n">bool</span> <span class="nv">$isEnd</span><span class="p">)</span>
    <span class="p">{}</span>

    <span class="cd">/**
     * @return array&lt;int, Position&gt;
     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">getNeighbors</span><span class="p">():</span> <span class="kt">array</span>
    <span class="p">{</span>
        <span class="nv">$neighbors</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">top</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$neighbors</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">top</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">right</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$neighbors</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">bottom</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$neighbors</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">bottom</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">left</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$neighbors</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$neighbors</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
              </td>
            </tr>
          </tbody>
        </table>
      </code></pre>
  </div>
</div>
<p>So we can instantiate this class  with some basic information:</p>
<ul>
  <li>the vertical and horizontal position on the map,</li>
  <li>the height of the field,</li>
  <li>a flag whether it’s the target field or not.</li>
</ul>
<p>For the neighboring fields we created four nullable properties. Obviously the fields on the sides at least one neighbor is <code class="language-plaintext highlighter-rouge">NULL</code>.
  We also add a function to collect all non-NULL neighbors.</p>
<p>Now it’s time to create the height map from the input data:</p>
<div class="language-php highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="cd">/** @var array&lt;int, array&lt;int, Position&gt;&gt; $heightMap */</span>
<span class="nv">$heightMap</span> <span class="o">=</span> <span class="p">[];</span>
<span class="cd">/** @var array&lt;int,Position&gt; $startPositions */</span>
<span class="nv">$startPositions</span> <span class="o">=</span> <span class="p">[];</span>

<span class="c1">// Read file and fill the height map with positions</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$fn</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="k">__DIR__</span> <span class="mf">.</span> <span class="s1">'/input.txt'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">((</span><span class="nv">$line</span> <span class="o">=</span> <span class="nb">fgets</span><span class="p">(</span><span class="nv">$fn</span><span class="p">,</span> <span class="mi">1024</span><span class="p">))</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$line</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span>
        <span class="nv">$letters</span> <span class="o">=</span> <span class="nb">str_split</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span>
        <span class="nv">$cols</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$letters</span><span class="p">);</span>
        <span class="nv">$heightMap</span><span class="p">[</span><span class="nv">$row</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$letters</span> <span class="k">as</span> <span class="nv">$col</span> <span class="o">=&gt;</span> <span class="nv">$character</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$height</span> <span class="o">=</span> <span class="nf">match</span><span class="p">(</span><span class="nv">$character</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="s1">'S'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">'E'</span> <span class="o">=&gt;</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">'z'</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">'a'</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="k">default</span> <span class="o">=&gt;</span> <span class="nb">ord</span><span class="p">(</span><span class="nv">$character</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">'a'</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="p">};</span>
            <span class="nv">$position</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Position</span><span class="p">(</span>
                <span class="n">row</span><span class="o">:</span> <span class="nv">$row</span><span class="p">,</span>
                <span class="n">col</span><span class="o">:</span> <span class="nv">$col</span><span class="p">,</span>
                <span class="n">height</span><span class="o">:</span> <span class="nv">$height</span><span class="p">,</span>
                <span class="n">isEnd</span><span class="o">:</span> <span class="nv">$character</span> <span class="o">===</span> <span class="s1">'E'</span>
            <span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="nv">$character</span> <span class="o">===</span> <span class="s1">'S'</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$startPositions</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$position</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nv">$heightMap</span><span class="p">[</span><span class="nv">$row</span><span class="p">][</span><span class="nv">$col</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$position</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nv">$row</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fn</span><span class="p">);</span>
<span class="p">}</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<p>Although for part one there’s only one start position, I use an array to store it, because in part two there are multiple
  start positions, so my goal is to achieve both tasks with the less work.</p>
<p>The trick here is the same I used before: convert the characters into numbers. This way, I will get mutually exclusive correspondence:</p>
<ul>
  <li>for <code class="language-plaintext highlighter-rouge">a</code> we will get <code class="language-plaintext highlighter-rouge">1</code>,</li>
  <li>for <code class="language-plaintext highlighter-rouge">b</code> we will get <code class="language-plaintext highlighter-rouge">2</code>,</li>
  <li>…</li>
  <li>for <code class="language-plaintext highlighter-rouge">z</code> we will get <code class="language-plaintext highlighter-rouge">26</code>.</li>
</ul>
<p>There are the two special cases:</p>
<ul>
  <li>for <code class="language-plaintext highlighter-rouge">S</code> we set the height to <code class="language-plaintext highlighter-rouge">1</code> and add the current position to the <code class="language-plaintext highlighter-rouge">$startPositions</code>,</li>
  <li>for <code class="language-plaintext highlighter-rouge">E</code> we set the height to <code class="language-plaintext highlighter-rouge">26</code> and use this information on the <code class="language-plaintext highlighter-rouge">Position</code>’s constructor.</li>
</ul>
<p>The only reason is to store these <code class="language-plaintext highlighter-rouge">Position</code> instances in a multidimensional array is to keep the relative positions between
  the fields. Therefore, we have all to <code class="language-plaintext highlighter-rouge">Position</code>s, so we can link the neighbors by reference.</p>
<p>But we do it smart: we link the neighbor field only when it fulfills the <a href="#game-rules">Game rules</a>:</p>
<div class="language-php highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="k">foreach</span> <span class="p">(</span><span class="nv">$heightMap</span> <span class="k">as</span> <span class="nv">$row</span> <span class="o">=&gt;</span> <span class="nv">$cols</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$cols</span> <span class="k">as</span> <span class="nv">$col</span> <span class="o">=&gt;</span> <span class="nv">$position</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$heightMap</span><span class="p">[</span><span class="nv">$row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="nv">$col</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$top</span> <span class="o">=</span> <span class="nv">$heightMap</span><span class="p">[</span><span class="nv">$row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="nv">$col</span><span class="p">];</span>

            <span class="k">if</span> <span class="p">(</span><span class="nv">$position</span><span class="o">-&gt;</span><span class="n">height</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="nv">$top</span><span class="o">-&gt;</span><span class="n">height</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$position</span><span class="o">-&gt;</span><span class="n">top</span> <span class="o">=</span> <span class="nv">$top</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$cols</span><span class="p">[</span><span class="nv">$col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$right</span> <span class="o">=</span> <span class="nv">$cols</span><span class="p">[</span><span class="nv">$col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>

            <span class="k">if</span> <span class="p">(</span><span class="nv">$position</span><span class="o">-&gt;</span><span class="n">height</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="nv">$right</span><span class="o">-&gt;</span><span class="n">height</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$position</span><span class="o">-&gt;</span><span class="n">right</span> <span class="o">=</span> <span class="nv">$right</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$heightMap</span><span class="p">[</span><span class="nv">$row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="nv">$col</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$bottom</span> <span class="o">=</span> <span class="nv">$heightMap</span><span class="p">[</span><span class="nv">$row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="nv">$col</span><span class="p">];</span>

            <span class="k">if</span> <span class="p">(</span><span class="nv">$position</span><span class="o">-&gt;</span><span class="n">height</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="nv">$bottom</span><span class="o">-&gt;</span><span class="n">height</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$position</span><span class="o">-&gt;</span><span class="n">bottom</span> <span class="o">=</span> <span class="nv">$bottom</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$cols</span><span class="p">[</span><span class="nv">$col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$left</span> <span class="o">=</span> <span class="nv">$cols</span><span class="p">[</span><span class="nv">$col</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>

            <span class="k">if</span> <span class="p">(</span><span class="nv">$position</span><span class="o">-&gt;</span><span class="n">height</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="nv">$left</span><span class="o">-&gt;</span><span class="n">height</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$position</span><span class="o">-&gt;</span><span class="n">left</span> <span class="o">=</span> <span class="nv">$left</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<p>Now, we have the <code class="language-plaintext highlighter-rouge">Position</code>s properly initializes, it’s time to  find the path. For this I create a new class, called <code class="language-plaintext highlighter-rouge">Path</code>:</p>
<div class="language-php highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="kd">class</span> <span class="nc">Path</span>
<span class="p">{</span>
    <span class="cd">/** @var array&lt;int array&lt;int, int&gt;&gt; */</span>
    <span class="k">public</span> <span class="kt">array</span> <span class="nv">$distanceMap</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="cd">/** @var array&lt;int, Position&gt;  */</span>
    <span class="k">public</span> <span class="kt">array</span> <span class="nv">$queue</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">public</span> <span class="kt">?Position</span> <span class="nv">$endPosition</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="kt">public</span> <span class="nc">Position</span> <span class="nv">$startPosition</span><span class="p">,</span> <span class="kt">public</span> <span class="n">int</span> <span class="nv">$rows</span><span class="p">,</span> <span class="kt">public</span> <span class="n">int</span> <span class="nv">$cols</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$tmp</span> <span class="o">=</span> <span class="nb">array_fill</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">cols</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">distanceMap</span> <span class="o">=</span> <span class="nb">array_fill</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">rows</span><span class="p">,</span> <span class="nv">$tmp</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">startPosition</span><span class="o">-&gt;</span><span class="n">distance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">queue</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$startPosition</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">findPath</span><span class="p">():</span> <span class="kt">void</span>
    <span class="p">{</span>
        <span class="k">do</span> <span class="p">{</span>
            <span class="nv">$current</span> <span class="o">=</span> <span class="nb">array_shift</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">queue</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="nv">$current</span><span class="o">-&gt;</span><span class="n">isEnd</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">endPosition</span> <span class="o">=</span> <span class="nv">$current</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="nv">$current</span><span class="o">-&gt;</span><span class="n">isVisited</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nv">$current</span><span class="o">-&gt;</span><span class="n">isVisited</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">distanceMap</span><span class="p">[</span><span class="nv">$current</span><span class="o">-&gt;</span><span class="n">row</span><span class="p">][</span><span class="nv">$current</span><span class="o">-&gt;</span><span class="n">col</span><span class="p">]</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">distanceMap</span><span class="p">[</span><span class="nv">$current</span><span class="o">-&gt;</span><span class="n">row</span><span class="p">][</span><span class="nv">$current</span><span class="o">-&gt;</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$current</span><span class="o">-&gt;</span><span class="n">distance</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nv">$neighbors</span> <span class="o">=</span> <span class="nv">$current</span><span class="o">-&gt;</span><span class="nf">getNeighbors</span><span class="p">();</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$neighbors</span> <span class="k">as</span> <span class="nv">$position</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nv">$position</span><span class="o">-&gt;</span><span class="n">distance</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$position</span><span class="o">-&gt;</span><span class="n">distance</span> <span class="o">=</span> <span class="nv">$current</span><span class="o">-&gt;</span><span class="n">distance</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">queue</span> <span class="o">=</span> <span class="nb">array_merge</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">queue</span><span class="p">,</span> <span class="nv">$neighbors</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="nb">empty</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">queue</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">printDistanceMap</span><span class="p">():</span> <span class="kt">void</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$row</span> <span class="o">&lt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">rows</span><span class="p">;</span> <span class="nv">$row</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
           <span class="k">for</span> <span class="p">(</span><span class="nv">$col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$col</span> <span class="o">&lt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">cols</span><span class="p">;</span> <span class="nv">$col</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
               <span class="k">echo</span> <span class="nb">str_pad</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">distanceMap</span><span class="p">[</span><span class="nv">$row</span><span class="p">][</span><span class="nv">$col</span><span class="p">],</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">' '</span><span class="p">,</span> <span class="no">STR_PAD_BOTH</span><span class="p">)</span><span class="mf">.</span><span class="s1">' |'</span><span class="p">;</span>
           <span class="p">}</span>
           <span class="k">echo</span> <span class="kc">PHP_EOL</span><span class="p">;</span>
           <span class="k">echo</span> <span class="nb">str_repeat</span><span class="p">(</span><span class="s1">'------+'</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">cols</span><span class="p">)</span><span class="mf">.</span><span class="kc">PHP_EOL</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<p>To start, we need to initialize this class with the <code class="language-plaintext highlighter-rouge">$startPosition</code> and number of rows and columns of the height map.
  Inside this class we will create a new “map”, a multidimensional array to track the distance, we already climbed.</p>
<p>We will also need a queue know how many <code class="language-plaintext highlighter-rouge">Position</code>s more we need to climb. The path find process ends in two cases:</p>
<ul>
  <li>we reach the <em>End</em>,</li>
  <li>we run out of <code class="language-plaintext highlighter-rouge">Position</code>s in the queue.</li>
</ul>
<p>Upon instantiation, we add the <code class="language-plaintext highlighter-rouge">$startPosition</code> directly into the queue. Then we call the <code class="language-plaintext highlighter-rouge">findPath()</code> public method, that
  will start the search:</p>
<ul>
  <li>It takes the first element out from the queue.</li>
  <li>If the current <code class="language-plaintext highlighter-rouge">Position</code> is the <em>End</em>, we save the <code class="language-plaintext highlighter-rouge">Position</code> in to the <code class="language-plaintext highlighter-rouge">endPosition</code> property and stop the process.</li>
  <li>If the current <code class="language-plaintext highlighter-rouge">Position</code> is marked as already visited, we skip to the next <code class="language-plaintext highlighter-rouge">Position</code> in the queue. We can do that, because
    when we visited it earlier, that means we already added all its neighbors to the queue.</li>
  <li>Mark the current <code class="language-plaintext highlighter-rouge">Position</code> as visited.</li>
  <li>If the current <code class="language-plaintext highlighter-rouge">Position</code> is not yet recorded in the <code class="language-plaintext highlighter-rouge">distanceMap</code>, we save the <code class="language-plaintext highlighter-rouge">Position</code>’s distance into it.</li>
  <li>We get the current <code class="language-plaintext highlighter-rouge">Position</code>’s neighbors. And check one-by-one:
    <ul>
      <li>If the given neighbor has no distance set, we set the current <code class="language-plaintext highlighter-rouge">Position</code>’s distance, plus one.</li>
    </ul>
  </li>
  <li>Merge the neighbors into the queue. Most likely there will be a ton of redundancy in the queue, but the <code class="language-plaintext highlighter-rouge">isVisited</code> check
    will fasten up the process.</li>
</ul>
<p>I also added a <code class="language-plaintext highlighter-rouge">printDistanceMap</code> method to visualize, which <code class="language-plaintext highlighter-rouge">Position</code>s were checked during the process.</p>
<h3 id="part-one">Part one</h3>
<p>Now we have everything to complete the task. Here we have one fix starting point, so our script will look like the following:</p>
<div class="language-php highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="nv">$rows</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$heightMap</span><span class="p">);</span>
<span class="nv">$cols</span> <span class="o">=</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$heightMap</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>

<span class="nv">$path</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Path</span><span class="p">(</span>
    <span class="n">startPosition</span><span class="o">:</span> <span class="nv">$startPositions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">rows</span><span class="o">:</span> <span class="nv">$rows</span><span class="p">,</span>
    <span class="n">cols</span><span class="o">:</span> <span class="nv">$cols</span>
<span class="p">);</span>
<span class="nv">$path</span><span class="o">-&gt;</span><span class="nf">findPath</span><span class="p">();</span>

<span class="k">echo</span> <span class="nv">$path</span><span class="o">-&gt;</span><span class="n">endPosition</span><span class="o">-&gt;</span><span class="n">distance</span><span class="mf">.</span><span class="kc">PHP_EOL</span><span class="p">;</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<h3 id="part-two">Part two</h3>
<p>Here we have to take all the level 1 fields as start point, and find the shortest of them all. For this, we need to modify
  our part one code only a bit:</p>
<div class="language-php highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="c1">// ...</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$fn</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="k">__DIR__</span> <span class="mf">.</span> <span class="s1">'/input.txt'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">while</span> <span class="p">((</span><span class="nv">$line</span> <span class="o">=</span> <span class="nb">fgets</span><span class="p">(</span><span class="nv">$fn</span><span class="p">,</span> <span class="mi">1024</span><span class="p">))</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// ...</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$letters</span> <span class="k">as</span> <span class="nv">$col</span> <span class="o">=&gt;</span> <span class="nv">$character</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// ...</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$height</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$startPositions</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$position</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="c1">// ...</span>
        <span class="p">}</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
    <span class="c1">// ...</span>
<span class="p">}</span>

<span class="c1">// ...</span>

<span class="nv">$minimalPath</span> <span class="o">=</span> <span class="kc">PHP_INT_MAX</span><span class="p">;</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$startPositions</span> <span class="k">as</span> <span class="nv">$start</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$path</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Path</span><span class="p">(</span>
        <span class="n">startPosition</span><span class="o">:</span> <span class="nv">$start</span><span class="p">,</span>
        <span class="n">rows</span><span class="o">:</span> <span class="nv">$rows</span><span class="p">,</span>
        <span class="n">cols</span><span class="o">:</span> <span class="nv">$cols</span>
    <span class="p">);</span>
    <span class="nv">$path</span><span class="o">-&gt;</span><span class="nf">findPath</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$path</span><span class="o">-&gt;</span><span class="n">endPosition</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$minimalPath</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nv">$minimalPath</span><span class="p">,</span> <span class="nv">$path</span><span class="o">-&gt;</span><span class="n">endPosition</span><span class="o">-&gt;</span><span class="n">distance</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$row</span> <span class="o">&lt;</span> <span class="nv">$rows</span><span class="p">;</span> <span class="nv">$row</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="nv">$col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$col</span> <span class="o">&lt;</span> <span class="nv">$cols</span><span class="p">;</span> <span class="nv">$col</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$heightMap</span><span class="p">[</span><span class="nv">$row</span><span class="p">][</span><span class="nv">$col</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">isVisited</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="nv">$heightMap</span><span class="p">[</span><span class="nv">$row</span><span class="p">][</span><span class="nv">$col</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">distance</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">echo</span> <span class="nv">$minimalPath</span><span class="mf">.</span><span class="kc">PHP_EOL</span><span class="p">;</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<p>One small thing to notice here: we should not forget to “reset” every <code class="language-plaintext highlighter-rouge">Position</code> in every loop.</p>
</div>
<footer class="a-footer">
  <h3 class="a-footer__title">About the author</h3>
  <a class="a-footer__avatar" href="/author/gabor.ivan/index.html"><img src="/author/gabor.ivan/avatar.jpg" alt="Gábor Iván"></a>
  <p class="a-footer__author">
    Hi, my name is Gábor Iván. I am an old-school Full stack developer, which means I deal with Backend (PHP), Frontend (HTML, CSS, JS), and a little bit of Webdesign. No DevOPS, sorry.
    <br>
    <a href="/author/gabor.ivan/index.html">Read the full story</a>
  </p>
</footer>
</article>
<aside class="a-comments">
  <header class="a-comments__title">
    <h4>It's time to judge me!</h4>
  </header>
  <div id="general">
    There's no embedded tool to judge me in public. But don't worry, you can
    <a class="mailto" href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#119;&#111;&#114;&#115;&#116;&#46;&#112;&#114;&#97;&#99;&#116;&#105;&#99;&#101;&#46;&#98;&#108;&#111;&#103;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;?subject=Judgement on `Advent of Code - Day 12`" target="_blank" rel="noopener" rel="noopener noreferrer">write me</a>
    your opinions/ideas/suggestions in email. Please don't forget to reference the page in the message.
  </div>
</aside>
</section>
</main>
<footer class="f-footer">
  <p class="f-footer__copyright">
    <small>Copyright © 2022 All rights reserved. Worst Practice</small>
  </p>
</footer>
</body>
</html>