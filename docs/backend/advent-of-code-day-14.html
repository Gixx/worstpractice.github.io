<!DOCTYPE html><html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Advent of Code - Day 14&nbsp;-&nbsp;Worst Practice
    </title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0">
    <meta name="language" content="en">
    <meta name="robots" content="index,follow">
    <meta name="generator" content="jekyll 3.8.5">
    <meta name="revisit-after" content="7 days">
    <meta name="distribution" content="web">
    <meta name="copyright" content="Copyright © 2022 All rights reserved. Worst Practice.">
    <meta name="description" content="
">
    <meta name="subject" content="">
    <meta name="keywords" content="PHP, Advent of Code">
    <!-- facebook share -->
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Worst Practice">
    <meta property="og:title" content="Advent of Code - Day 14&nbsp;-&nbsp;Worst Practice
">
    <meta property="og:url" content="https://www.worstpractice.dev/backend/advent-of-code-day-14">
    <meta name="date" content="2022-12-14T16:25:00+00:00">
    <meta property="og:image" content="https://www.worstpractice.dev/assets/img/blog/2022/backend/advent-of-code-day-14/advent-14.jpg">
    <meta property="og:image:width" content="600">
    <meta property="og:image:height" content="600">
    <meta property="og:description" content="A nice sand-fall game, with very simple logic.">
    <meta property="fb:admins" content="ivan.gabor.80">
    <meta property="fb:app_id" content="2178081495757871">
    <meta property="og:type" content="article">
    <meta property="article:author" content="https://www.facebook.com/ivan.gabor.80">
    <meta property="article:published_time" content="2022-12-14T16:25:00+00:00">
    <meta property="article:tag" content="blog"/>
    <!-- twitter share -->
    <meta name="twitter:title" content="Advent of Code - Day 14">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:creator" content="@gaborivan1980">
    <meta name="twitter:description" content="A nice sand-fall game, with very simple logic.">
    <meta name="twitter:image" content="https://www.worstpractice.dev/assets/img/blog/2022/backend/advent-of-code-day-14/advent-14_600x600.jpg">
    <link rel="canonical" href="https://www.worstpractice.dev">
    <link rel="alternate" type="application/rss+xml" title="Advent of Code - Day 14&nbsp;-&nbsp;Worst Practice
" href="/feed.xml">
    <link rel="alternate" hreflang="en" href="https://www.worstpractice.dev/backend/advent-of-code-day-14">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/img/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/img/icons/android-chrome-192x192.png">
    <link rel="manifest" href="/assets/img/icons/site.webmanifest">
    <link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg" color="#C23F2F">
    <link rel="shortcut icon" href="/assets/img/icons/favicon.ico">
    <meta name="msapplication-TileColor" content="#C23F2F">
    <meta name="msapplication-TileImage" content="/assets/img/icons/mstile-144x144.png">
    <meta name="msapplication-config" content="/assets/img/icons/browserconfig.xml">
    <meta name="theme-color" content="#C23F2F">
    <meta name="application-name" content="Worst Practice Blog">
    <meta name="HandheldFriendly" content="true">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#C23F2F">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:300,300i,400,400i,700,700i">
    <link rel="stylesheet" href="/assets/css/site.css">
    <script type="application/javascript" src="/assets/js/feature.min.js"></script>
    <script type="application/javascript">
      if (!feature.srcset) {
          window.location.href = '/sorry.html';
      }
    </script>
    <script type="application/javascript" src="/assets/js/site.min.js"></script>
  </head>
  <body>
    <header class="h-header">
      <h1 class="h-header__title"><a href="/">Worst Practice</a></h1>
    </header>
    <div class="codeOfTheDay">
      <input class="codeOfTheDay__toggle" type="checkbox">
      <div class="codeOfTheDay__content"></div>
      <div class="codeOfTheDay__monitor"></div>
      <div class="codeOfTheDay__backdrop"></div>
    </div>
    <div class="m-menu">
      <div class="m-menu__burger">
        <span></span>
      </div>
      <input class="m-menu__toggle" type="checkbox" />
      <div class="m-menu__content">
        <nav>
          <h2 class="m-menu__title">Worst Practice</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -home" href="/">Home</a></li>
          </ul>
        </nav>
        <nav>
          <h2 class="m-menu__title">Categories</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -backend -current" href="/backend">Backend</a></li>
            <li><a class="m-menu__link -devenv" href="/devenv">Development Environment</a></li>
            <li><a class="m-menu__link -frontend" href="/frontend">Frontend</a></li>
            <li><a class="m-menu__link -general
" href="/general
">General</a></li>
          </ul>
        </nav>
        <nav>
          <h2 class="m-menu__title">Tags</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -php" rel="tag" href="/tags/php/">PHP <sup>20</sup></a></li>
            <li><a class="m-menu__link -advent" rel="tag" href="/tags/advent/">Advent <sup>15</sup></a></li>
            <li><a class="m-menu__link -php74" rel="tag" href="/tags/php74/">PHP 7.4 <sup>4</sup></a></li>
          </ul>
          <a class="m-menu__link -more" href="/tags/">More</a>
        </nav>
        <nav>
          <h2 class="m-menu__title">Archive</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link " href="/archive/2022-12/">December, 2022</a></li>
            <li><a class="m-menu__link " href="/archive/2022-11/">November, 2022</a></li>
            <li><a class="m-menu__link " href="/archive/2022-10/">October, 2022</a></li>
          </ul>
          <a class="m-menu__link -more" href="/archive/">More</a>
        </nav>
        <nav>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link " href="/imprint.html">Imprint</a></li>
            <li><a class="m-menu__link " href="/terms.html">Terms of Use</a></li>
            <li><a class="m-menu__link " href="/privacy.html">Privacy Policy</a></li>
          </ul>
        </nav>
      </div>
      <div class="m-menu__backdrop"></div>
    </div>
    <main class="c-content">
      <section class="c-content__article">
        <article class="a-article">
          <header class="a-header">
            <h2 class="a-header__title">Advent of Code - Day 14</h2>
            <div class="a-header__meta">
              <p class="a-meta__date">Posted on December&nbsp;14, 2022 @ 16:25
              </p>
              <p class="a-meta__category">Posted under the <a href="/backend/index.html">Backend</a> category</p>
              <p class="a-meta__level">Level: beginner</p>
              <p class="a-meta__tags">Posted with the following tags:
                <a href="/tags/advent/index.html">#Advent</a>, 
                <a href="/tags/php/index.html">#PHP</a>
              </p>
            </div>
          </header>
          <p class="a-excerpt">
            A nice sand-fall game, with very simple logic.
          </p>
          <figure class="a-illustration">
            <img class="a-illustration__image" src="/assets/img/post-illustration-placeholder.png" data-src="/assets/img/blog/2022/backend/advent-of-code-day-14/advent-14.jpg" alt="Advent of Code - Day 14">
            <figcaption class="a-illustration__caption">Calendar icon by <a target="_blank" rel="noopener" href="https://pixabay.com/users/pinwhalestock-13691058/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4623521">Kevin Sanderson</a> from <a target="_blank" rel="noopener" href="https://pixabay.com//?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4623521">Pixabay</a></figcaption>
          </figure>
          <div class="a-body">
            <p><a href="https://adventofcode.com/2022/day/14" rel="noopener" target="_blank">Today’s puzzle</a> in short: If you ever played
              to the original <a href="https://en.wikipedia.org/wiki/Boulder_Dash" rel="noopener" target="_blank">Boulder Dash</a> game 
              in the ’80s, you know what this game is about.</p>
            <p>If you didn’t, well here’s a very nice example from the game, that also highlights the physics, that we need to re-create:</p>
            <iframe class="yt" width="560" height="315" src="https://www.youtube-nocookie.com/embed/Nj-ldSUTFCg?start=17" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
            <h3 id="the-input-data">The input data</h3>
            <p>This time the input data is pretty complex: simulates drawing horizontal and vertical lines.</p>
            <ul>
              <li>Each line contains chained coordinates:
                <ul>
                  <li>X and Y coordinates are separated by comma,</li>
                  <li>positions are separated by <code class="language-plaintext highlighter-rouge">-&gt;</code>.</li>
                </ul>
              </li>
              <li>Between coordinates the <code class="language-plaintext highlighter-rouge">-&gt;</code> represents a vector (movement), so the coordinates on its sides are start and end points 
                of a continuous line (range).</li>
              <li>The coordinates are counted left to right, top to bottom.</li>
            </ul>
            <h4 id="game-rules">Game rules</h4>
            <p>The given 2 dimensional data set represents the 2D schema of a cave:</p>
            <ul>
              <li>Where we draw according to the coordinates and vectors, there are rocks.</li>
              <li>The remaining space is void air.</li>
              <li>There’s a leak on the roof at the coordinates 500,0.</li>
            </ul>
            <p>On the leak, sand flows inside the cave and fill it up:</p>
            <ul>
              <li>1 piece of sand falls at a time.</li>
              <li>It can fall 1 unit on our map at a time.</li>
              <li>If it hits a rock and there’s free space 1 unit down on left, it continues falling there.</li>
              <li>If it hits a rock and there’s free space 1 unit down on right, it continues falling there.</li>
              <li>If it hits a rock and there’s no free space 1 unit down on any of the sides, it takes a rest and the next piece of sand start the process again.</li>
            </ul>
            <h3 id="the-data-model">The Data model</h3>
            <p>The most difficult part of the code was actually parsing the input and create the matrix of the used spaces:</p>
            <div class="language-php highlighter-rouge">
              <div class="highlight">
                <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre>
              </td>
              <td class="rouge-code">
                <pre>
<span class="nv">$cave</span> <span class="o">=</span> <span class="p">[];</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$fn</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="k">__DIR__</span> <span class="mf">.</span> <span class="s1">'/input.txt'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">((</span><span class="nv">$line</span> <span class="o">=</span> <span class="nb">fgets</span><span class="p">(</span><span class="nv">$fn</span><span class="p">,</span> <span class="mi">1024</span><span class="p">))</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$line</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span>

        <span class="nv">$coordinates</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">' -&gt; '</span><span class="p">,</span> <span class="nv">$line</span><span class="p">);</span>

        <span class="nv">$previousX</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nv">$previousY</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$coordinates</span> <span class="k">as</span> <span class="nv">$coordinate</span><span class="p">)</span> <span class="p">{</span>
            <span class="p">[</span><span class="nv">$x</span><span class="p">,</span> <span class="nv">$y</span><span class="p">]</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">','</span><span class="p">,</span> <span class="nv">$coordinate</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="nv">$previousX</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nv">$previousY</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$cave</span><span class="p">[</span><span class="nv">$y</span><span class="p">][</span><span class="nv">$x</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'#'</span><span class="p">;</span>
                <span class="nv">$previousX</span> <span class="o">=</span> <span class="nv">$x</span><span class="p">;</span>
                <span class="nv">$previousY</span> <span class="o">=</span> <span class="nv">$y</span><span class="p">;</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nv">$distanceX</span> <span class="o">=</span> <span class="nv">$previousX</span> <span class="o">-</span> <span class="nv">$x</span><span class="p">;</span>
            <span class="nv">$distanceY</span> <span class="o">=</span> <span class="nv">$previousY</span> <span class="o">-</span> <span class="nv">$y</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="nv">$distanceX</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$iteratorX</span> <span class="o">=</span> <span class="nv">$distanceX</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>

                <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="nv">$x</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">!=</span> <span class="nv">$previousX</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">+=</span> <span class="nv">$iteratorX</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$cave</span><span class="p">[</span><span class="nv">$y</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'#'</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nv">$distanceY</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$iteratorY</span> <span class="o">=</span> <span class="nv">$distanceY</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>

                <span class="k">for</span> <span class="p">(</span><span class="nv">$j</span> <span class="o">=</span> <span class="nv">$y</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">!=</span> <span class="nv">$previousY</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">+=</span> <span class="nv">$iteratorY</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nv">$cave</span><span class="p">[</span><span class="nv">$j</span><span class="p">][</span><span class="nv">$x</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'#'</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="nv">$previousX</span> <span class="o">=</span> <span class="nv">$x</span><span class="p">;</span>
            <span class="nv">$previousY</span> <span class="o">=</span> <span class="nv">$y</span><span class="p">;</span>
        <span class="p">}</span>

    <span class="p">}</span>
    <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fn</span><span class="p">);</span>
<span class="p">}</span>
</pre>
              </td>
            </tr>
          </tbody>
        </table>
      </code></pre>
  </div>
</div>
<p>The only difficulty here is to calculate the ranges well and fill all the fields between the actual and previous coordinates.</p>
<h3 id="part-1">Part 1</h3>
<p>The map shows no ground for the cave, so the sand can fall into the eternity. We need to count the amount of sand remain on
  the rocks when the first piece falls to the nowhere.</p>
<div class="language-php highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="nv">$maxY</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$cave</span> <span class="k">as</span> <span class="nv">$y</span> <span class="o">=&gt;</span> <span class="nv">$columns</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$maxY</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nv">$maxY</span><span class="p">,</span> <span class="nv">$y</span><span class="p">);</span>
<span class="p">}</span>

<span class="nv">$restingSandCounter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nv">$y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nv">$x</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>

<span class="k">do</span> <span class="p">{</span>
    <span class="nv">$tmp</span> <span class="o">=</span> <span class="nv">$cave</span><span class="p">;</span>
    <span class="nv">$tmp</span><span class="p">[</span><span class="nv">$y</span><span class="p">][</span><span class="nv">$x</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'o'</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">isset</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">[</span><span class="nv">$y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="nv">$x</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$y</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="k">isset</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">[</span><span class="nv">$y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="nv">$x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$y</span><span class="o">++</span><span class="p">;</span>
        <span class="nv">$x</span><span class="o">--</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="o">!</span><span class="k">isset</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">[</span><span class="nv">$y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="nv">$x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$y</span><span class="o">++</span><span class="p">;</span>
        <span class="nv">$x</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$cave</span><span class="p">[</span><span class="nv">$y</span><span class="p">][</span><span class="nv">$x</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"o"</span><span class="p">;</span>
        <span class="nv">$y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nv">$x</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span>
        <span class="nv">$restingSandCounter</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">while</span> <span class="p">((</span><span class="nv">$y</span> <span class="o">&lt;</span> <span class="nv">$maxY</span> <span class="o">+</span> <span class="mi">2</span><span class="p">));</span>

<span class="k">echo</span> <span class="nv">$restingSandCounter</span><span class="mf">.</span><span class="kc">PHP_EOL</span><span class="p">;</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<p>Here we need to check how far is the bottom of the last rock from the top. We set the position of the leak, then start the
  process. Any sand piece that passes that height will stop the process. In the simple <code class="language-plaintext highlighter-rouge">do ... while</code> loop we apply the 
  physics rules and as soon as a sand piece finds its place, we increment the counter that will give the solution for the puzzle.</p>
<p>In every loop we add the sand to our <code class="language-plaintext highlighter-rouge">$cave</code>, so the next piece of sand can count with it.</p>
<p>We maybe could use <code class="language-plaintext highlighter-rouge">ksort()</code> to sort the <code class="language-plaintext highlighter-rouge">$cave</code> array by keys order to get the highest key, but I didn’t want to ruin
  the structure we built, maybe in the next part we need it.</p>
<h3 id="part-2">Part 2</h3>
<p>Now we realize, there’s a ground in the cave, actually we stand on it. We need to count how much sand can fill the cave
  according to the rules until the leak gets blocked. The process is the same, only some initialization and loop check changed:</p>
<div class="language-php highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="nv">$cave</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">500</span> <span class="o">=&gt;</span> <span class="s1">'+'</span><span class="p">]];</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$fn</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="k">__DIR__</span> <span class="mf">.</span> <span class="s1">'/input.txt'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<p>Now we have the same cave created, but now we need to add the ground to it. The game description says it can be infinite, 
  but that’s something that not easy to do with arrays, and also unnecessary. I guessed if the maximum height tripled in both
  directions is enough to not get into an infinite loop in the end:</p>
<div class="language-php highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="nv">$maxY</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
<span class="nv">$minX</span> <span class="o">=</span> <span class="mi">500</span> <span class="o">-</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="nv">$maxY</span><span class="p">);</span>
<span class="nv">$maxX</span> <span class="o">=</span> <span class="mi">500</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="nv">$maxY</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="nv">$minX</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$maxX</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$cave</span><span class="p">[</span><span class="nv">$maxY</span><span class="p">][</span><span class="nv">$i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'#'</span><span class="p">;</span>
<span class="p">}</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<p>I didn’t make any proper calculations on it, simply tried out:</p>
<ul>
  <li>multiplying with two ended in an infinite loop (or I was just impatient)</li>
  <li>multiplying with three worked.</li>
</ul>
<p>As the <code class="language-plaintext highlighter-rouge">$maxY</code> was the bottom of the last rock, we had to add 2 more units to the height:</p>
<ul>
  <li>One for an empty air (where we are too)</li>
  <li>One for the ground (that we stand on).</li>
</ul>
<p>The rest is almost the same, only the while expression changes:</p>
<div class="language-php highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="k">do</span> <span class="p">{</span>
    <span class="c1">/// ...</span>
<span class="p">}</span> <span class="k">while</span> <span class="p">((</span><span class="nv">$cave</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">500</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">"o"</span><span class="p">));</span>

<span class="k">echo</span> <span class="nv">$restingSandCounter</span><span class="mf">.</span><span class="kc">PHP_EOL</span><span class="p">;</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<h3 id="bonus">Bonus</h3>
<p>I’m a visual type guy. I can understand everything better, if I can see it. So for this puzzle too, I made a print function
  which I didn’t add to the code samples, since it won’t work on the full data set.</p>
<p>But it was good enough to print the initial state of our cave:</p>
<figure class="a-illustration">
  <img class="a-illustration__image" src="/assets/img/post-illustration-placeholder.png" data-src="/assets/img/blog/2022/backend/advent-of-code-day-14/cave.png" width="344" />
  <figcaption class="a-illustration__caption">Output sample of the </figcaption>
</figure>
</div>
<footer class="a-footer">
  <h3 class="a-footer__title">About the author</h3>
  <a class="a-footer__avatar" href="/author/gabor.ivan/index.html"><img src="/author/gabor.ivan/avatar.jpg" alt="Gábor Iván"></a>
  <p class="a-footer__author">
    Hi, my name is Gábor Iván. I am an old-school Full stack developer, which means I deal with Backend (PHP), Frontend (HTML, CSS, JS), and a little bit of Webdesign. No DevOPS, sorry.
    <br>
    <a href="/author/gabor.ivan/index.html">Read the full story</a>
  </p>
</footer>
</article>
<aside class="a-comments">
  <header class="a-comments__title">
    <h4>It's time to judge me!</h4>
  </header>
  <div id="general">
    There's no embedded tool to judge me in public. But don't worry, you can
    <a class="mailto" href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#119;&#111;&#114;&#115;&#116;&#46;&#112;&#114;&#97;&#99;&#116;&#105;&#99;&#101;&#46;&#98;&#108;&#111;&#103;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;?subject=Judgement on `Advent of Code - Day 14`" target="_blank" rel="noopener" rel="noopener noreferrer">write me</a>
    your opinions/ideas/suggestions in email. Please don't forget to reference the page in the message.
  </div>
</aside>
</section>
</main>
<footer class="f-footer">
  <p class="f-footer__copyright">
    <small>Copyright © 2022 All rights reserved. Worst Practice</small>
  </p>
</footer>
</body>
</html>