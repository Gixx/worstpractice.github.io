<!DOCTYPE html><html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Advent of Code - Day 5&nbsp;-&nbsp;Worst Practice
    </title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0">
    <meta name="language" content="en">
    <meta name="robots" content="index,follow">
    <meta name="generator" content="jekyll 3.8.5">
    <meta name="revisit-after" content="7 days">
    <meta name="distribution" content="web">
    <meta name="copyright" content="Copyright © 2022 All rights reserved. Worst Practice.">
    <meta name="description" content="
">
    <meta name="subject" content="">
    <meta name="keywords" content="PHP, Advent of Code">
    <!-- facebook share -->
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Worst Practice">
    <meta property="og:title" content="Advent of Code - Day 5&nbsp;-&nbsp;Worst Practice
">
    <meta property="og:url" content="https://www.worstpractice.dev/backend/advent-of-code-day-5">
    <meta name="date" content="2022-12-05T16:30:00+00:00">
    <meta property="og:image" content="https://www.worstpractice.dev/assets/img/blog/2022/backend/advent-of-code-day-5/advent-5.jpg">
    <meta property="og:image:width" content="600">
    <meta property="og:image:height" content="600">
    <meta property="og:description" content="Christmas town is a big factory with a big warehouse. And in this warehouse the elves need to organize crates with the world-famous `CrateMover 9001`">
    <meta property="fb:admins" content="ivan.gabor.80">
    <meta property="fb:app_id" content="2178081495757871">
    <meta property="og:type" content="article">
    <meta property="article:author" content="https://www.facebook.com/ivan.gabor.80">
    <meta property="article:published_time" content="2022-12-05T16:30:00+00:00">
    <meta property="article:tag" content="blog"/>
    <!-- twitter share -->
    <meta name="twitter:title" content="Advent of Code - Day 5">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:creator" content="@gaborivan1980">
    <meta name="twitter:description" content="Christmas town is a big factory with a big warehouse. And in this warehouse the elves need to organize crates with the world-famous `CrateMover 9001`">
    <meta name="twitter:image" content="https://www.worstpractice.dev/assets/img/blog/2022/backend/advent-of-code-day-5/advent-5_600x600.jpg">
    <link rel="canonical" href="https://www.worstpractice.dev">
    <link rel="alternate" type="application/rss+xml" title="Advent of Code - Day 5&nbsp;-&nbsp;Worst Practice
" href="/feed.xml">
    <link rel="alternate" hreflang="en" href="https://www.worstpractice.dev/backend/advent-of-code-day-5">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/img/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/img/icons/android-chrome-192x192.png">
    <link rel="manifest" href="/assets/img/icons/site.webmanifest">
    <link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg" color="#C23F2F">
    <link rel="shortcut icon" href="/assets/img/icons/favicon.ico">
    <meta name="msapplication-TileColor" content="#C23F2F">
    <meta name="msapplication-TileImage" content="/assets/img/icons/mstile-144x144.png">
    <meta name="msapplication-config" content="/assets/img/icons/browserconfig.xml">
    <meta name="theme-color" content="#C23F2F">
    <meta name="application-name" content="Worst Practice Blog">
    <meta name="HandheldFriendly" content="true">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#C23F2F">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:300,300i,400,400i,700,700i">
    <link rel="stylesheet" href="/assets/css/site.css">
    <script type="application/javascript" src="/assets/js/feature.min.js"></script>
    <script type="application/javascript">
      if (!feature.srcset) {
          window.location.href = '/sorry.html';
      }
    </script>
    <script type="application/javascript" src="/assets/js/site.min.js"></script>
  </head>
  <body>
    <header class="h-header">
      <h1 class="h-header__title"><a href="/">Worst Practice</a></h1>
    </header>
    <div class="codeOfTheDay">
      <input class="codeOfTheDay__toggle" type="checkbox">
      <div class="codeOfTheDay__content"></div>
      <div class="codeOfTheDay__monitor"></div>
      <div class="codeOfTheDay__backdrop"></div>
    </div>
    <div class="m-menu">
      <div class="m-menu__burger">
        <span></span>
      </div>
      <input class="m-menu__toggle" type="checkbox" />
      <div class="m-menu__content">
        <nav>
          <h2 class="m-menu__title">Worst Practice</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -home" href="/">Home</a></li>
          </ul>
        </nav>
        <nav>
          <h2 class="m-menu__title">Categories</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -devenv" href="/devenv">Development Environment</a></li>
            <li><a class="m-menu__link -general" href="/general">General</a></li>
            <li><a class="m-menu__link -backend -current" href="/backend">Backend</a></li>
            <li><a class="m-menu__link -frontend" href="/frontend">Frontend</a></li>
            <li><a class="m-menu__link -general
" href="/general
">General</a></li>
          </ul>
        </nav>
        <nav>
          <h2 class="m-menu__title">Tags</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link -php" rel="tag" href="/tags/php/">PHP <sup>20</sup></a></li>
            <li><a class="m-menu__link -advent" rel="tag" href="/tags/advent/">Advent <sup>15</sup></a></li>
            <li><a class="m-menu__link -php74" rel="tag" href="/tags/php74/">PHP 7.4 <sup>4</sup></a></li>
          </ul>
          <a class="m-menu__link -more" href="/tags/">More</a>
        </nav>
        <nav>
          <h2 class="m-menu__title">Archive</h2>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link " href="/archive/2023-01/">January, 2023</a></li>
            <li><a class="m-menu__link " href="/archive/2022-12/">December, 2022</a></li>
            <li><a class="m-menu__link " href="/archive/2022-11/">November, 2022</a></li>
          </ul>
          <a class="m-menu__link -more" href="/archive/">More</a>
        </nav>
        <nav>
          <ul class="m-menu__navigation">
            <li><a class="m-menu__link " href="/imprint.html">Imprint</a></li>
            <li><a class="m-menu__link " href="/terms.html">Terms of Use</a></li>
            <li><a class="m-menu__link " href="/privacy.html">Privacy Policy</a></li>
          </ul>
        </nav>
      </div>
      <div class="m-menu__backdrop"></div>
    </div>
    <main class="c-content">
      <section class="c-content__article">
        <article class="a-article">
          <header class="a-header">
            <h2 class="a-header__title">Advent of Code - Day 5</h2>
            <div class="a-header__meta">
              <p class="a-meta__date">Posted on December&nbsp; 5, 2022 @ 16:30
              </p>
              <p class="a-meta__category">Posted under the <a href="/backend/index.html">Backend</a> category</p>
              <p class="a-meta__level">Level: beginner</p>
              <p class="a-meta__tags">Posted with the following tags:
                <a href="/tags/advent/index.html">#Advent</a>, 
                <a href="/tags/php/index.html">#PHP</a>
              </p>
            </div>
          </header>
          <p class="a-excerpt">
            Christmas town is a big factory with a big warehouse. And in this warehouse the elves need to organize crates with the world-famous `CrateMover 9001`
          </p>
          <figure class="a-illustration">
            <img class="a-illustration__image" src="/assets/img/post-illustration-placeholder.png" data-src="/assets/img/blog/2022/backend/advent-of-code-day-5/advent-5.jpg" alt="Advent of Code - Day 5">
            <figcaption class="a-illustration__caption">Calendar icon by <a target="_blank" rel="noopener" href="https://pixabay.com/users/pinwhalestock-13691058/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4623521">Kevin Sanderson</a> from <a target="_blank" rel="noopener" href="https://pixabay.com//?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4623521">Pixabay</a></figcaption>
          </figure>
          <div class="a-body">
            <p><a href="https://adventofcode.com/2022/day/5" rel="noopener" target="_blank">Today’s puzzle</a> in short: for the first 
              sight I thought it will be a custom sorting algorithm, but in the end it became just a simple item movement between arrays.</p>
            <h3 id="the-input-data">The input data</h3>
            <p>For the first time, the input data contains additional information. We have to extract this information and create initial
              “warehouse” state in the PHP code. The input file must remain pilled with crane-movement orders.</p>
            <ul>
              <li>The first 10 lines must be deleted (can be added to the PHP code as comment)</li>
              <li>Each line has the same form of information: <code class="language-plaintext highlighter-rouge">move # from # to #</code>, where <code class="language-plaintext highlighter-rouge">#</code> is a decimal.*</li>
            </ul>
            <h4 id="game-rules">Game rules</h4>
            <p>The solution for the puzzle is to follow each order and move crates between the columns according to the command, where
              the numbers are defined as follows:</p>
            <ul>
              <li>The first number represents the amount of crates.</li>
              <li>The second number represents the source column.</li>
              <li>The third number represents the target column.</li>
            </ul>
            <p>Our task is to tell which item is on the top of each column.</p>
            <h3 id="part-one">Part one</h3>
            <p>Because of a misreading the elves predicted that the crane is the <code class="language-plaintext highlighter-rouge">CrateMover 9000</code> which can move only one item at a time.</p>
            <p>To solve this puzzle we need to think in arrays again and simple <code class="language-plaintext highlighter-rouge">pop</code> and <code class="language-plaintext highlighter-rouge">push</code> elements.</p>
            <div class="language-php highlighter-rouge">
              <div class="highlight">
                <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre>
              </td>
              <td class="rouge-code">
                <pre><span class="nv">$storage</span> <span class="o">=</span> <span class="p">[</span>
    <span class="kc">null</span><span class="p">,</span>
    <span class="nb">str_split</span><span class="p">(</span><span class="s1">'QFMRLWCV'</span><span class="p">),</span>
    <span class="nb">str_split</span><span class="p">(</span><span class="s1">'DQL'</span><span class="p">),</span>
    <span class="nb">str_split</span><span class="p">(</span><span class="s1">'PSRGWCNB'</span><span class="p">),</span>
    <span class="nb">str_split</span><span class="p">(</span><span class="s1">'LCDHBQG'</span><span class="p">),</span>
    <span class="nb">str_split</span><span class="p">(</span><span class="s1">'VGLFZS'</span><span class="p">),</span>
    <span class="nb">str_split</span><span class="p">(</span><span class="s1">'DGNP'</span><span class="p">),</span>
    <span class="nb">str_split</span><span class="p">(</span><span class="s1">'DZPVECW'</span><span class="p">),</span>
    <span class="nb">str_split</span><span class="p">(</span><span class="s1">'CPDMS'</span><span class="p">),</span>
    <span class="nb">str_split</span><span class="p">(</span><span class="s1">'ZNWTVMPC'</span><span class="p">),</span>
<span class="p">];</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$fn</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="k">__DIR__</span><span class="mf">.</span><span class="s1">'/input.txt'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">((</span><span class="nv">$line</span> <span class="o">=</span> <span class="nb">fgets</span><span class="p">(</span><span class="nv">$fn</span><span class="p">,</span> <span class="mi">1024</span><span class="p">))</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$line</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span>
        <span class="nv">$command</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/move (?P&lt;iteration&gt;\d+) from (?P&lt;from&gt;\d+) to (?P&lt;to&gt;\d+)/'</span><span class="p">,</span> <span class="nv">$line</span><span class="p">,</span> <span class="nv">$command</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$command</span><span class="p">[</span><span class="s1">'iteration'</span><span class="p">];</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$storage</span><span class="p">[</span><span class="nv">$command</span><span class="p">[</span><span class="s1">'to'</span><span class="p">]][]</span> <span class="o">=</span> <span class="nb">array_pop</span><span class="p">(</span><span class="nv">$storage</span><span class="p">[</span><span class="nv">$command</span><span class="p">[</span><span class="s1">'from'</span><span class="p">]]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fn</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$storage</span> <span class="k">as</span> <span class="nv">$column</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">empty</span><span class="p">(</span><span class="nv">$column</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>
    <span class="k">echo</span> <span class="nb">end</span><span class="p">(</span><span class="nv">$column</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">echo</span> <span class="kc">PHP_EOL</span><span class="p">;</span>
</pre>
              </td>
            </tr>
          </tbody>
        </table>
      </code></pre>
  </div>
</div>
<p>As you can see, first of all, I initialized the warehouse in a more readable way: string which is being split into array 
  of characters. Why should I give up something that works?</p>
<p>Then I used regular expression again to extract the numeric information out from the command. Then just simply do an 
  <code class="language-plaintext highlighter-rouge">array_pop()</code> and an <code class="language-plaintext highlighter-rouge">array_push</code> (with a simpler syntax) within a for loop.</p>
<p>In the end, we go through the final state of the <code class="language-plaintext highlighter-rouge">$storage</code> and print the last element of each item.</p>
<h3 id="part-two">Part two</h3>
<p>Now the elves figured out their mistake, and realized that the crane is actually a <code class="language-plaintext highlighter-rouge">CrateMover 9001</code>, which can move multiple 
  items at a time. This will change the results for sure.</p>
<p>Technically this means, either:</p>
<ul>
  <li>We keep the loop and the <code class="language-plaintext highlighter-rouge">array_pop</code>, but then we need to collect these popped items into a new array, and then reverse
    it before pushing to the target column.</li>
  <li>We find a way to pop as many items at once as we need, and pushing them one-by-one to the target column.</li>
</ul>
<p>The second option sounds better because:</p>
<ul>
  <li>We can eliminate an ugly loop.</li>
  <li>PHP has a built-in function to pop multiple elements</li>
  <li>The <code class="language-plaintext highlighter-rouge">array_push</code> can accept multiple elements</li>
  <li>We have the chance to use the <code class="language-plaintext highlighter-rouge">...</code> spread-operator which is always a nice thing.</li>
</ul>
<p>So the new code will look like this:</p>
<div class="language-php highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre>
  </td>
  <td class="rouge-code">
    <pre><span class="c1">// ... $storage</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$fn</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="k">__DIR__</span><span class="mf">.</span><span class="s1">'/input.txt'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">((</span><span class="nv">$line</span> <span class="o">=</span> <span class="nb">fgets</span><span class="p">(</span><span class="nv">$fn</span><span class="p">,</span> <span class="mi">1024</span><span class="p">))</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$line</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$line</span><span class="p">);</span>
        <span class="nv">$command</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">preg_match</span><span class="p">(</span><span class="s1">'/move (?P&lt;slice&gt;\d+) from (?P&lt;from&gt;\d+) to (?P&lt;to&gt;\d+)/'</span><span class="p">,</span> <span class="nv">$line</span><span class="p">,</span> <span class="nv">$command</span><span class="p">))</span> <span class="p">{</span>
            <span class="nb">array_push</span><span class="p">(</span><span class="nv">$storage</span><span class="p">[</span><span class="nv">$command</span><span class="p">[</span><span class="s1">'to'</span><span class="p">]],</span> <span class="mf">...</span><span class="nb">array_splice</span><span class="p">(</span><span class="nv">$storage</span><span class="p">[</span><span class="nv">$command</span><span class="p">[</span><span class="s1">'from'</span><span class="p">]],</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="nv">$command</span><span class="p">[</span><span class="s1">'slice'</span><span class="p">]));</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nb">fclose</span><span class="p">(</span><span class="nv">$fn</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$storage</span> <span class="k">as</span> <span class="nv">$column</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">empty</span><span class="p">(</span><span class="nv">$column</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>
    <span class="k">echo</span> <span class="nb">end</span><span class="p">(</span><span class="nv">$column</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">echo</span> <span class="kc">PHP_EOL</span><span class="p">;</span>
</pre>
  </td>
</tr>
</tbody>
</table>
</code></pre>
</div>
</div>
<p>We need to be careful with sticky keys on the keyboard, because I had an annoying debug session to figure out why I don’t 
  get the right result. The reason was, I used <code class="language-plaintext highlighter-rouge">array_slice()</code> and not <code class="language-plaintext highlighter-rouge">array_splice()</code>. Even with a typo the code was valid
  but it gave an absolute wrong answer for the task.</p>
</div>
<footer class="a-footer">
  <h3 class="a-footer__title">About the author</h3>
  <a class="a-footer__avatar" href="/author/gabor.ivan/index.html"><img src="/author/gabor.ivan/avatar.jpg" alt="Gábor Iván"></a>
  <p class="a-footer__author">
    Hi, my name is Gábor Iván. I am an old-school Full stack developer, which means I deal with Backend (PHP), Frontend (HTML, CSS, JS), and a little bit of Webdesign. No DevOPS, sorry.
    <br>
    <a href="/author/gabor.ivan/index.html">Read the full story</a>
  </p>
</footer>
</article>
<aside class="a-comments">
  <header class="a-comments__title">
    <h4>It's time to judge me!</h4>
  </header>
  <div id="general">
    There's no embedded tool to judge me in public. But don't worry, you can
    <a class="mailto" href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#119;&#111;&#114;&#115;&#116;&#46;&#112;&#114;&#97;&#99;&#116;&#105;&#99;&#101;&#46;&#98;&#108;&#111;&#103;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;?subject=Judgement on `Advent of Code - Day 5`" target="_blank" rel="noopener" rel="noopener noreferrer">write me</a>
    your opinions/ideas/suggestions in email. Please don't forget to reference the page in the message.
  </div>
</aside>
</section>
</main>
<footer class="f-footer">
  <p class="f-footer__copyright">
    <small>Copyright © 2023 All rights reserved. Worst Practice</small>
  </p>
</footer>
</body>
</html>